<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - Organic HypoSolutions</title>
    <meta name="description" content="Complete your order of premium USDA Certified Organic HOCl products. Secure checkout with volume discounts and wholesale pricing available.">
    <meta name="keywords" content="organic cleaning product cart, professional disinfectant ordering, bulk sanitizer purchasing, Utah cleaning supply order, commercial product checkout, disinfectant bulk pricing, professional sanitizer cart, organic product ordering, cleaning supply purchasing, subscription cleaning products">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-blue: #2E5EAA;
            --light-blue: #7DD3FC;
            --primary-green: #4ADE80;
            --secondary-green: #22C55E;
            --dark-navy: #1e3a8a;
            --warning-gold: #f59e0b;
            --light-gray: #f8fafc;
            --danger-color: #dc3545;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-gray);
        }

        /* Navigation Styles - FIXED ICON ALIGNMENT */
        .navbar {
            background: linear-gradient(135deg, var(--primary-blue), var(--light-blue)) !important;
        }

        .navbar-brand {
            font-weight: 700;
            color: white !important;
        }

        /* FIX: Proper icon and text alignment */
        .nav-link {
            color: white !important;
            transition: color 0.3s ease;
            font-weight: 500;
            display: flex !important;
            align-items: center !important;
            gap: 0.5rem !important;
        }

        .nav-link:hover {
            color: var(--light-blue) !important;
            background-color: rgba(255,255,255,0.1);
            border-radius: 4px;
        }

        .nav-link.active {
            color: var(--light-blue) !important;
            font-weight: 600;
        }

        /* Dropdown toggle alignment fix */
        .dropdown-toggle {
            display: flex !important;
            align-items: center !important;
            gap: 0.5rem !important;
        }

        /* Mobile nav fixes */
        @media (max-width: 991.98px) {
            .navbar-nav .nav-link {
                padding: 0.5rem 0.75rem !important;
                display: flex !important;
                align-items: center !important;
                gap: 0.5rem !important;
            }
        }

        .navbar-toggler {
            border-color: rgba(255,255,255,0.3);
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='m4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }

        /* Dropdown menu styling */
        .dropdown-menu {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: none;
            border-radius: 8px;
        }

        .dropdown-item {
            padding: 0.75rem 1.25rem;
            transition: background-color 0.3s ease;
            display: flex !important;
            align-items: center !important;
            gap: 0.5rem !important;
        }

        .dropdown-item:hover {
            background-color: var(--light-gray);
            color: var(--primary-blue);
        }

        .dropdown-item i {
            width: 20px;
            flex-shrink: 0;
        }

        /* Badge Styles */
        .badge {
            font-size: 0.7rem;
        }

        .badge-under-construction {
            background-color: var(--warning-gold);
            color: #fff;
        }

        .badge-wholesale {
            background-color: var(--primary-blue);
            color: #fff;
        }

        .badge-organic {
            background-color: var(--primary-green);
            color: #fff;
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, var(--primary-blue), var(--light-blue));
            color: white;
            padding: 3rem 0;
        }

        /* Cart Container */
        .cart-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-top: -2rem;
            position: relative;
            z-index: 10;
        }

        .cart-item {
            border-bottom: 1px solid #e9ecef;
            padding: 1.5rem 0;
            transition: all 0.3s ease;
        }

        .cart-item:hover {
            background-color: #f8f9fa;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .product-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            background: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
        }

        /* Quantity Controls */
        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quantity-btn {
            width: 35px;
            height: 35px;
            border: 1px solid #dee2e6;
            background: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quantity-btn:hover {
            background: var(--light-blue);
            border-color: var(--primary-blue);
            color: white;
        }

        .quantity-input {
            width: 60px;
            text-align: center;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 0.375rem;
        }

        /* Order Summary */
        .order-summary {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 2rem;
            position: sticky;
            top: 2rem;
        }

        .summary-row {
            display: flex;
            justify-content: between;
            padding: 0.5rem 0;
            border-bottom: 1px solid #dee2e6;
        }

        .summary-row:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--primary-blue);
        }

        /* Professional Service Section */
        .professional-service {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px dashed var(--primary-blue);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
        }

        /* Checkout Section */
        .checkout-section {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .payment-icons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 1rem 0;
        }

        .payment-icon {
            width: 40px;
            height: 25px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: #6c757d;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .hero-section {
                padding: 2rem 0;
            }
            
            .cart-container {
                margin: 0 1rem;
                margin-top: -1rem;
            }
            
            .order-summary {
                position: static;
                margin-top: 2rem;
            }
            
            .product-details {
                margin-top: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation - FIXED ALIGNMENT -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="../index.html">
                <!-- OHS Logo -->
                <svg width="40" height="40" viewBox="0 0 400 250" class="me-2">
                    <rect width="400" height="250" fill="#2E5EAA"/>
                    <text x="200" y="180" text-anchor="middle" fill="#7DD3FC" font-family="Arial, sans-serif" font-size="100" font-weight="bold">OHS</text>
                    <text x="200" y="210" text-anchor="middle" fill="#7DD3FC" font-family="Arial, sans-serif" font-size="20">Organic HypoSolutions</text>
                    <path d="M 320 80 Q 340 60 360 80 Q 340 100 320 80" fill="#4ADE80"/>
                    <path d="M 330 70 Q 350 50 370 70 Q 350 90 330 70" fill="#22C55E"/>
                </svg>
                <span class="fw-bold">Organic HypoSolutions</span>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">
                            <i class="fas fa-home"></i>
                            <span>Home</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../services.html">
                            <i class="fas fa-spray-can"></i>
                            <span>Services</span>
                        </a>
                    </li>
                    
                    <!-- Products Dropdown - FIXED -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="productsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-leaf"></i>
                            <span>Products</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="../products.html">
                                <i class="fas fa-boxes"></i>
                                <span>All Products</span>
                            </a></li>
                            <li><a class="dropdown-item" href="../products.html#organic">
                                <i class="fas fa-seedling"></i>
                                <span>USDA Organic Line</span>
                                <span class="badge badge-organic ms-2">Certified</span>
                            </a></li>
                            <li><a class="dropdown-item" href="../products.html#premium">
                                <i class="fas fa-star"></i>
                                <span>EPA Premium Line</span>
                                <span class="badge badge-wholesale ms-2">Professional</span>
                            </a></li>
                        </ul>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="../calculator.html">
                            <i class="fas fa-calculator"></i>
                            <span>Calculator</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../about.html">
                            <i class="fas fa-info-circle"></i>
                            <span>About</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../science-certifications.html">
                            <i class="fas fa-certificate"></i>
                            <span>Science & Certifications</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../legal-information.html">
                            <i class="fas fa-gavel"></i>
                            <span>Legal Information</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../contact.html">
                            <i class="fas fa-phone"></i>
                            <span>Contact</span>
                        </a>
                    </li>
                    
                    <!-- Shop Dropdown - FIXED CART COUNT -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="shopDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-shopping-bag"></i>
                            <span>Shop</span>
                            <span id="cartBadge" class="badge bg-danger ms-1" style="display: none;">0</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="../products.html">
                                <i class="fas fa-boxes"></i>
                                <span>All Products</span>
                            </a></li>
                            <li><a class="dropdown-item active" href="cart.html">
                                <i class="fas fa-shopping-cart"></i>
                                <span>Cart</span>
                                <span id="cartBadgeDropdown" class="badge bg-danger ms-1" style="display: none;">0</span>
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="checkout.html">
                                <i class="fas fa-credit-card"></i>
                                <span>Checkout</span>
                                <span class="badge badge-under-construction ms-1">Under Construction</span>
                            </a></li>
                            <li><a class="dropdown-item" href="account.html">
                                <i class="fas fa-user"></i>
                                <span>My Account</span>
                                <span class="badge badge-under-construction ms-1">Under Construction</span>
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="wholesale.html">
                                <i class="fas fa-handshake"></i>
                                <span>Wholesale Portal</span>
                                <span class="badge badge-wholesale ms-1">Business</span>
                            </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container text-center">
            <h1 class="display-4 fw-bold mb-3">Your Shopping Cart</h1>
            <p class="lead">Complete your order of premium USDA Certified Organic HOCl products</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="cart-container p-4">
            <!-- Promo Banner -->
            <div class="alert alert-warning text-center mb-4" role="alert">
                <i class="fas fa-shipping-fast me-2"></i>
                <strong>Limited Time:</strong> FREE SHIPPING on all orders + Volume Discounts up to 20% OFF!
            </div>

            <div class="row">
                <!-- Cart Items -->
                <div class="col-lg-8">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3>Shopping Cart</h3>
                        <small class="text-muted" id="itemCount">0 items</small>
                        <button class="btn btn-outline-danger btn-sm" onclick="clearCart()">
                            <i class="fas fa-trash"></i> Clear Cart
                        </button>
                    </div>

                    <!-- Cart Items Container -->
                    <div id="cartItems">
                        <!-- Cart items will be loaded here -->
                    </div>

                    <!-- Empty Cart Message -->
                    <div id="emptyCart" class="text-center py-5" style="display: none;">
                        <i class="fas fa-shopping-cart text-muted" style="font-size: 4rem;"></i>
                        <h4 class="text-muted mt-3">Your cart is empty</h4>
                        <p class="text-muted">Add some products to get started!</p>
                        <a href="../products.html" class="btn btn-primary">
                            <i class="fas fa-shopping-bag me-2"></i>Browse Products
                        </a>
                    </div>

                    <!-- Professional Service Add-on -->
                    <div class="professional-service">
                        <h5><i class="fas fa-tools text-primary me-2"></i>Add Professional Service</h5>
                        <p class="mb-3">Combine product orders with professional sanitization services for maximum protection.</p>
                        <div class="row">
                            <div class="col-md-6">
                                <button class="btn btn-outline-primary w-100 mb-2" onclick="calculateService()">
                                    <i class="fas fa-calculator me-2"></i>Calculate Service Cost
                                </button>
                            </div>
                            <div class="col-md-6">
                                <button class="btn btn-primary w-100">
                                    <i class="fas fa-calendar-plus me-2"></i>Book Service
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="col-lg-4">
                    <div class="order-summary">
                        <h4 class="mb-4">Order Summary</h4>
                        
                        <div class="summary-row">
                            <span>Subtotal:</span>
                            <span id="subtotal">$61.35</span>
                        </div>
                        <div class="summary-row">
                            <span>Volume Discount:</span>
                            <span id="discount" class="text-success">-$9.20</span>
                        </div>
                        <div class="summary-row">
                            <span>Shipping:</span>
                            <span id="shipping" class="text-success">FREE</span>
                        </div>
                        <div class="summary-row">
                            <span>Tax (UT 7.75%):</span>
                            <span id="tax">$4.75</span>
                        </div>
                        <hr>
                        <div class="summary-row">
                            <span>Total:</span>
                            <span id="total">$66.10</span>
                        </div>

                        <!-- Coupon Code -->
                        <div class="mt-4">
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="Enter coupon code" id="couponCode">
                                <button class="btn btn-outline-secondary" type="button" onclick="applyCoupon()">Apply</button>
                            </div>
                            <small class="text-muted">
                                <i class="fas fa-tag me-1"></i>Shopify coupon integration ready
                            </small>
                        </div>

                        <!-- Checkout Section -->
                        <div class="checkout-section mt-4">
                            <h5 class="mb-3">Secure Checkout</h5>
                            <div class="payment-icons">
                                <div class="payment-icon">VISA</div>
                                <div class="payment-icon">MC</div>
                                <div class="payment-icon">AMEX</div>
                                <div class="payment-icon">PP</div>
                                <div class="payment-icon">APay</div>
                            </div>
                            <button class="btn btn-primary w-100 btn-lg" onclick="proceedToCheckout()">
                                <i class="fas fa-lock me-2"></i>Secure Checkout
                            </button>
                            <small class="d-block text-center text-muted mt-2">
                                <i class="fas fa-shield-alt me-1"></i>256-bit SSL encryption
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-5 mt-5">
        <div class="container">
            <div class="row">
                <!-- Company Info -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="d-flex align-items-center mb-3">
                        <!-- OHS Logo -->
                        <svg width="40" height="40" viewBox="0 0 400 250" class="me-2">
                            <rect width="400" height="250" fill="#2E5EAA"/>
                            <text x="200" y="180" text-anchor="middle" fill="#7DD3FC" font-family="Arial, sans-serif" font-size="100" font-weight="bold">OHS</text>
                            <text x="200" y="210" text-anchor="middle" fill="#7DD3FC" font-family="Arial, sans-serif" font-size="20">Organic HypoSolutions</text>
                            <path d="M 320 80 Q 340 60 360 80 Q 340 100 320 80" fill="#4ADE80"/>
                            <path d="M 330 70 Q 350 50 370 70 Q 350 90 330 70" fill="#22C55E"/>
                        </svg>
                        <h5 class="mb-0">Organic HypoSolutions</h5>
                    </div>
                    <p class="small">Utah's premier USDA Certified Organic HOCl sanitization services and products.</p>
                    
                    <!-- Business Info -->
                    <div class="small mb-2">
                        <strong>Business License:</strong> #1565171-0160<br>
                        <strong>Phone:</strong> (801) 712-5663
                    </div>
                    
                    <!-- USDA Certification Badge -->
                    <div class="mt-3">
                        <span class="badge bg-success">
                            <i class="fas fa-certificate me-1"></i>USDA Certified Organic
                        </span>
                    </div>
                </div>

                <!-- Services -->
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6>Services</h6>
                    <ul class="list-unstyled small">
                        <li><a href="../services.html#fogging" class="text-light text-decoration-none">Professional Fogging</a></li>
                        <li><a href="../services.html#commercial" class="text-light text-decoration-none">Commercial Cleaning</a></li>
                        <li><a href="../services.html#residential" class="text-light text-decoration-none">Residential Service</a></li>
                        <li><a href="../calculator.html" class="text-light text-decoration-none">Service Calculator</a></li>
                    </ul>
                </div>

                <!-- Products -->
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6>Products</h6>
                    <ul class="list-unstyled small">
                        <li><a href="../products.html#organic" class="text-light text-decoration-none">USDA Organic Line</a></li>
                        <li><a href="../products.html#premium" class="text-light text-decoration-none">EPA Premium Line</a></li>
                        <li><a href="../products.html" class="text-light text-decoration-none">All Products</a></li>
                    </ul>
                    <span class="badge bg-primary small mt-2">Coming Soon</span>
                </div>

                <!-- Company -->
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6>Company</h6>
                    <ul class="list-unstyled small">
                        <li><a href="../about.html" class="text-light text-decoration-none">About Us</a></li>
                        <li><a href="../science-certifications.html" class="text-light text-decoration-none">Science & Certifications</a></li>
                        <li><a href="../legal-information.html" class="text-light text-decoration-none">Legal Information</a></li>
                        <li><a href="../contact.html" class="text-light text-decoration-none">Contact</a></li>
                    </ul>
                </div>

                <!-- Contact -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <h6>Contact</h6>
                    <div class="small">
                        <div class="mb-2">
                            <i class="fas fa-phone me-2"></i>(801) 712-5663
                        </div>
                        <div class="mb-2">
                            <i class="fas fa-envelope me-2"></i>info@organichyposolutions.com
                        </div>
                        <div class="mb-3">
                            <i class="fas fa-map-marker-alt me-2"></i>Salt Lake City, Utah
                        </div>
                    </div>

                    <!-- Social Media -->
                    <div class="d-flex gap-3">
                        <a href="#" class="text-light">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="text-light">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="text-light">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="#" class="text-light">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </div>
                </div>
            </div>
            
            <hr class="my-4">
            
            <!-- Footer Bottom -->
            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="mb-0 small">&copy; 2025 Organic HypoSolutions. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="small">
                        <a href="../privacy-policy.html" class="text-light text-decoration-none me-3">Privacy Policy</a>
                        <a href="../terms-of-service.html" class="text-light text-decoration-none me-3">Terms of Service</a>
                        <a href="../science-certifications.html" class="text-light text-decoration-none">Certifications</a>
                    </div>
                    <p class="mb-0 small mt-1">This website is for educational purposes only. <a href="../legal-information.html" class="text-light">See Legal Information</a></p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- FIXED CART FUNCTIONALITY -->
    <script>
        // Consistent cart storage key
        const CART_STORAGE_KEY = 'ohsCart';

        // Sample cart data for demo
        let cart = [
            {
                id: 'ohs-organic-32oz',
                name: '32oz Ready to Use Hypochlorous Acid',
                description: 'EPA registered, USDA certified organic disinfectant',
                price: 21.80,
                originalPrice: 25.60,
                quantity: 2,
                image: '../assets/images/products/32oz-organic.jpg',
                badges: ['USDA Organic', 'Health & Safety'],
                savings: '15%'
            },
            {
                id: 'all-in-one-wipes',
                name: 'All-In-One Wipes',
                description: 'Professional grade cleaning wipes',
                price: 24.29,
                quantity: 1,
                image: '../assets/images/products/wipes.jpg',
                badges: ['USDA Organic', 'Cleaning Supplies']
            }
        ];

        // FIXED: Update cart badge function
        function updateCartBadge() {
            try {
                const cartData = JSON.parse(localStorage.getItem(CART_STORAGE_KEY) || JSON.stringify(cart));
                const totalItems = cartData.reduce((sum, item) => sum + (item.quantity || 0), 0);
                
                // Update both badge locations
                const badges = ['cartBadge', 'cartBadgeDropdown'];
                badges.forEach(badgeId => {
                    const badge = document.getElementById(badgeId);
                    if (badge) {
                        if (totalItems > 0) {
                            badge.textContent = totalItems;
                            badge.style.display = 'inline-block';
                        } else {
                            badge.style.display = 'none';
                        }
                    }
                });
                
                // Update item count text
                const itemCount = document.getElementById('itemCount');
                if (itemCount) {
                    itemCount.textContent = `${totalItems} items`;
                }
                
            } catch (error) {
                console.log('Error updating cart badge:', error);
            }
        }

        // Load cart from localStorage or use demo data
        function loadCart() {
            try {
                const storedCart = localStorage.getItem(CART_STORAGE_KEY);
                return storedCart ? JSON.parse(storedCart) : cart;
            } catch (error) {
                console.log('Error loading cart:', error);
                return cart;
            }
        }

        // Save cart to localStorage
        function saveCart() {
            try {
                localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cart));
                updateCartBadge();
            } catch (error) {
                console.log('Error saving cart:', error);
            }
        }

        // Render cart items
        function renderCartItems() {
            const cartContainer = document.getElementById('cartItems');
            const emptyCart = document.getElementById('emptyCart');
            
            cart = loadCart();
            
            if (cart.length === 0) {
                cartContainer.style.display = 'none';
                emptyCart.style.display = 'block';
                return;
            }
            
            cartContainer.style.display = 'block';
            emptyCart.style.display = 'none';
            
            cartContainer.innerHTML = cart.map(item => `
                <div class="cart-item" id="item-${item.id}">
                    <div class="row align-items-center">
                        <div class="col-md-2">
                            <div class="product-image">
                                <i class="fas fa-spray-can text-primary"></i>
                            </div>
                        </div>
                        <div class="col-md-4 product-details">
                            <h6 class="mb-1">${item.name}</h6>
                            <small class="text-muted">${item.description}</small>
                            <div class="mt-1">
                                ${item.badges ? item.badges.map(badge => 
                                    `<span class="badge bg-success me-1">${badge}</span>`
                                ).join('') : ''}
                                ${item.savings ? `<span class="badge bg-warning">Save ${item.savings}</span>` : ''}
                            </div>
                        </div>
                        <div class="col-md-2 text-center">
                            <div class="quantity-controls">
                                <button class="quantity-btn" onclick="updateQuantity('${item.id}', ${item.quantity - 1})">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <input type="number" class="quantity-input" value="${item.quantity}" 
                                       onchange="updateQuantity('${item.id}', this.value)" min="0">
                                <button class="quantity-btn" onclick="updateQuantity('${item.id}', ${item.quantity + 1})">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="col-md-2 text-center">
                            ${item.originalPrice ? 
                                `<div class="text-muted"><small><del>$${item.originalPrice.toFixed(2)}</del></small></div>` : 
                                ''
                            }
                            <div class="fw-bold text-success">$${item.price.toFixed(2)}</div>
                        </div>
                        <div class="col-md-2 text-center">
                            <div class="fw-bold">$${(item.price * item.quantity).toFixed(2)}</div>
                            <button class="btn btn-outline-danger btn-sm mt-1" onclick="removeItem('${item.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            updateCartBadge();
            calculateTotals();
        }

        // Update quantity
        function updateQuantity(itemId, newQuantity) {
            newQuantity = parseInt(newQuantity);
            if (newQuantity < 0) return;
            
            if (newQuantity === 0) {
                removeItem(itemId);
                return;
            }
            
            cart = cart.map(item => 
                item.id === itemId ? { ...item, quantity: newQuantity } : item
            );
            
            saveCart();
            renderCartItems();
        }

        // Remove item
        function removeItem(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            saveCart();
            renderCartItems();
        }

        // Clear cart
        function clearCart() {
            if (confirm('Are you sure you want to clear your cart?')) {
                cart = [];
                saveCart();
                renderCartItems();
            }
        }

        // Calculate totals
        function calculateTotals() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const discount = subtotal * 0.15; // 15% volume discount
            const tax = (subtotal - discount) * 0.0775; // Utah tax
            const total = subtotal - discount + tax;
            
            document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('discount').textContent = `-$${discount.toFixed(2)}`;
            document.getElementById('tax').textContent = `$${tax.toFixed(2)}`;
            document.getElementById('total').textContent = `$${total.toFixed(2)}`;
        }

        // Apply coupon
        function applyCoupon() {
            const couponCode = document.getElementById('couponCode').value;
            alert(`Coupon functionality will be integrated with Shopify. Code entered: ${couponCode}`);
        }

        // Calculate service
        function calculateService() {
            window.open('../calculator.html', '_blank');
        }

        // Proceed to checkout
        function proceedToCheckout() {
            alert('Checkout functionality will be integrated with Shopify platform.');
        }

        // Listen for storage changes (cart updates from other pages)
        window.addEventListener('storage', function(e) {
            if (e.key === CART_STORAGE_KEY) {
                renderCartItems();
            }
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            renderCartItems();
            updateCartBadge();
        });

        // Update badge when page gains focus
        window.addEventListener('focus', function() {
            updateCartBadge();
        });
    </script>
</body>
</html>
