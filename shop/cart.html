<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- BRAND-FOCUSED TITLE: Targets your exact search terms -->
    <title>Shopping Cart | OHSHOCL | Organic Hypo Solutions | Utah Organic Sanitization Products</title>
    
    <!-- CLEAN META DESCRIPTION: Natural brand messaging -->
    <meta name="description" content="Complete your order of premium USDA Certified Organic and EPA registered hypochlorous acid products. Professional disinfectant supplies and organic cleaning solutions from Utah's trusted sanitization company.">

    <!-- BRAND KEYWORDS: SEO optimization -->
    <meta name="keywords" content="organic cleaning product cart, professional disinfectant ordering, bulk sanitizer purchasing, subscription cleaning products, Utah cleaning supply order, commercial product checkout, disinfectant bulk pricing, professional sanitizer cart, organic product ordering, cleaning supply purchasing">

    <!-- STANDARD SEO -->
    <meta name="author" content="OHSHOCL - Organic Hypo Solutions">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    
    <!-- CANONICAL URL -->
    <link rel="canonical" href="https://organichyposolutions.com/shop/cart.html">

    <!-- LOCATION TARGETING -->
    <meta name="geo.region" content="US-UT">
    <meta name="geo.placename" content="Utah">
    <meta name="geo.position" content="40.7608;-111.8910">
    <meta name="ICBM" content="40.7608, -111.8910">

    <!-- BUSINESS INFO -->
    <meta name="business.phone" content="+1-801-712-5663">
    <meta name="business.email" content="ohshocl@gmail.com">
    <meta name="business.hours" content="Mo-Fr 08:00-18:00, Sa 09:00-17:00">

    <!-- SOCIAL SHARING -->
    <meta property="og:title" content="Shopping Cart | OHSHOCL | Utah Organic Sanitization Products">
    <meta property="og:description" content="Complete your order of premium USDA Certified Organic and EPA registered disinfectant products for professional and residential use.">
    <meta property="og:url" content="https://organichyposolutions.com/shop/cart.html">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://organichyposolutions.com/images/ohs-cart-social.jpg">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="OHSHOCL">

    <!-- TWITTER CARDS -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Shopping Cart | OHSHOCL | Utah Organic Sanitization Products">
    <meta name="twitter:description" content="Professional hypochlorous acid products. USDA Certified Organic and EPA registered for commercial and residential use.">
    <meta name="twitter:image" content="https://organichyposolutions.com/images/ohs-cart-social.jpg">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HEKE217WEY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-HEKE217WEY');
    </script>
    
    <style>
        :root {
            --ohs-primary-blue: #2E5EAA;
            --ohs-accent-blue: #7DD3FC;
            --ohs-organic-green: #4ADE80;
            --ohs-dark-green: #22C55E;
            --ohs-premium-gold: #f59e0b;
            --ohs-light-gray: #f8f9fa;
            --ohs-dark-gray: #6c757d;
        }

        /* EXACT NAVBAR STYLING FROM REFERENCE */
        .navbar {
            background-color: #2E5EAA !important;
            padding: 0.3rem 0 !important;
            box-shadow: none !important;
            min-height: 80px !important;
        }

        .navbar-brand {
            color: white !important;
            font-size: 1.5rem !important;
            font-weight: bold !important;
            padding: 0.2rem 0 !important;
            display: flex !important;
            align-items: center !important;
        }

        .navbar-brand svg {
            width: 32px !important;
            height: 32px !important;
        }

        .navbar-nav .nav-link {
            color: white !important;
            font-weight: 500 !important;
            padding: 0.5rem 1rem !important;
            margin: 0 !important;
            border-radius: 0 !important;
            transition: all 0.2s ease !important;
            display: flex !important;
            align-items: center !important;
        }

        .navbar-nav .nav-link i {
            margin-right: 0.5rem !important;
            font-size: 0.9rem !important;
        }

        .navbar-nav .nav-link:hover {
            color: #7DD3FC !important;
            background-color: rgba(255, 255, 255, 0.1) !important;
        }

        .navbar-nav .nav-link.active,
        .navbar-nav .nav-link.fw-semibold {
            color: #7DD3FC !important;
            background-color: rgba(255, 255, 255, 0.15) !important;
        }

        /* Override Bootstrap navbar defaults */
        .navbar-light .navbar-nav .nav-link {
            color: white !important;
        }

        .navbar-light .navbar-nav .nav-link:hover,
        .navbar-light .navbar-nav .nav-link:focus {
            color: #7DD3FC !important;
        }

        .navbar-light .navbar-brand {
            color: white !important;
        }

        .navbar-light .navbar-brand:hover,
        .navbar-light .navbar-brand:focus {
            color: white !important;
        }

        /* Dropdown Styling */
        .dropdown-menu {
            background-color: white !important;
            border: none !important;
            border-radius: 8px !important;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1) !important;
            padding: 0.5rem 0 !important;
            margin-top: 0.25rem !important;
        }

        .dropdown-item {
            color: #2E5EAA !important;
            padding: 0.5rem 1rem !important;
            border-radius: 0 !important;
            transition: all 0.2s ease !important;
        }

        .dropdown-item:hover,
        .dropdown-item:focus {
            background-color: #f8f9fa !important;
            color: #2E5EAA !important;
        }

        .dropdown-item i {
            width: 16px !important;
            margin-right: 8px !important;
        }

        .badge {
            font-size: 0.7rem !important;
            font-weight: normal !important;
        }

        /* Navbar toggler for mobile */
        .navbar-toggler {
            border-color: rgba(255, 255, 255, 0.3) !important;
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") !important;
        }

        /* Mobile responsiveness */
        @media (max-width: 991.98px) {
            .navbar-nav .nav-link {
                padding: 0.5rem 0.75rem !important;
            }
        }

        /* Cart-specific styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--ohs-light-gray);
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, var(--ohs-primary-blue) 0%, var(--ohs-accent-blue) 100%);
            color: white;
            padding: 40px 0;
        }

        .cert-badge {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Cart Container */
        .cart-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-top: -3rem;
            position: relative;
            z-index: 10;
        }

        /* Cart Items */
        .cart-item {
            border-bottom: 2px solid #f1f5f9;
            padding: 2rem 0;
            transition: all 0.3s ease;
        }

        .cart-item:hover {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .product-image {
            width: 90px;
            height: 90px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border: 3px solid white;
        }

        .product-image.organic {
            background: linear-gradient(135deg, #22c55e, #16a34a);
        }

        .product-image.premium {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        /* FIXED QUANTITY CONTROLS - MAIN ISSUE */
        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            background: #f8fafc;
            padding: 0.8rem;
            border-radius: 15px;
            border: 2px solid #e2e8f0;
            justify-content: center;
        }

        .quantity-btn {
            width: 40px;
            height: 40px;
            border: 2px solid var(--ohs-organic-green);
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--ohs-organic-green);
            font-weight: bold;
            /* CRITICAL: Make sure buttons work */
            user-select: none;
            -webkit-user-select: none;
        }

        .quantity-btn:hover:not(:disabled) {
            background: var(--ohs-organic-green);
            color: white;
            transform: scale(1.05);
        }

        .quantity-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border-color: #ccc;
            color: #ccc;
        }

        .quantity-input {
            border: 2px solid var(--ohs-organic-green);
            background: white;
            border-radius: 8px;
            width: 60px;
            height: 40px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--ohs-primary-blue);
            outline: none;
            transition: all 0.3s ease;
        }

        .quantity-input:focus {
            border-color: var(--ohs-primary-blue);
            box-shadow: 0 0 8px rgba(46, 94, 170, 0.3);
        }

        .quantity-input::-webkit-outer-spin-button,
        .quantity-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .quantity-input[type=number] {
            -moz-appearance: textfield;
        }

        /* Recommendation quantity controls */
        .recommendation-quantity-controls {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            background: #f8fafc;
            padding: 0.3rem;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .quantity-btn-sm {
            width: 28px;
            height: 28px;
            border: 1px solid var(--ohs-organic-green);
            background: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--ohs-organic-green);
            font-weight: bold;
            font-size: 0.8rem;
            user-select: none;
        }

        .quantity-btn-sm:hover:not(:disabled) {
            background: var(--ohs-organic-green);
            color: white;
            transform: scale(1.05);
        }

        .quantity-btn-sm:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border-color: #ccc;
            color: #ccc;
        }

        .quantity-input-sm {
            border: 1px solid var(--ohs-organic-green);
            background: white;
            border-radius: 4px;
            width: 45px;
            height: 28px;
            text-align: center;
            font-weight: bold;
            font-size: 0.9rem;
            color: var(--ohs-primary-blue);
            outline: none;
            transition: all 0.3s ease;
        }

        .quantity-input-sm:focus {
            border-color: var(--ohs-primary-blue);
            box-shadow: 0 0 4px rgba(46, 94, 170, 0.3);
        }

        .quantity-input-sm::-webkit-outer-spin-button,
        .quantity-input-sm::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .quantity-input-sm[type=number] {
            -moz-appearance: textfield;
        }

        /* Pricing */
        .price-display {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--ohs-organic-green);
        }

        /* Order Summary */
        .order-summary {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border-radius: 20px;
            padding: 2.5rem;
            position: sticky;
            top: 2rem;
            border: 2px solid #e2e8f0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
        }

        .order-summary h4 {
            color: var(--ohs-primary-blue);
            font-weight: bold;
            border-bottom: 3px solid var(--ohs-organic-green);
            padding-bottom: 0.5rem;
            margin-bottom: 2rem;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 0.8rem 0;
            border-bottom: 1px solid #e2e8f0;
            font-weight: 500;
        }

        .summary-row:last-child {
            border-bottom: 3px solid var(--ohs-organic-green);
            font-weight: bold;
            font-size: 1.3rem;
            color: var(--ohs-primary-blue);
            background: linear-gradient(135deg, #ecfdf5, #dcfce7);
            margin: 1rem -1rem;
            padding: 1rem;
            border-radius: 12px;
        }

        .discount-text {
            color: #22c55e;
            font-weight: bold;
        }

        .free-shipping {
            color: #22c55e;
            font-weight: bold;
            text-transform: uppercase;
        }

        /* Checkout Button */
        .btn-checkout {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border: none;
            border-radius: 15px;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }

        .btn-checkout:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.6);
            background: linear-gradient(135deg, #1d4ed8, #1e40af);
        }

        /* Empty Cart */
        .empty-cart {
            text-align: center;
            padding: 4rem 2rem;
            color: #64748b;
        }

        .empty-cart i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }

        /* FOOTER STYLING - FIXED */
        .footer-section {
            background: #000000;
            color: white;
            padding: 3rem 0 2rem 0;
            margin-top: 3rem;
        }

        .footer-section h5, 
        .footer-section h6 {
            color: white;
            margin-bottom: 1rem;
        }

        .footer-section .text-white-50 {
            color: rgba(255, 255, 255, 0.75) !important;
            transition: color 0.2s ease;
        }

        .footer-section .text-white-50:hover {
            color: white !important;
        }

        .footer-cert {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
            margin: 0.125rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .footer-section hr {
            border-color: rgba(255, 255, 255, 0.2) !important;
        }

        /* Mobile */
        @media (max-width: 768px) {
            .hero-section {
                padding: 2rem 0;
            }
            
            .cart-container {
                margin: 0 1rem;
                margin-top: -1rem;
            }
            
            .order-summary {
                position: static;
                margin-top: 2rem;
            }

            .quantity-controls {
                gap: 0.5rem;
                padding: 0.5rem;
            }

            .quantity-btn {
                width: 35px;
                height: 35px;
            }
        }

        /* Under Construction Badge */
        .construction-badge {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Product Line Badges */
        .badge-organic {
            background: linear-gradient(135deg, var(--ohs-organic-green), var(--ohs-dark-green));
            color: white;
        }

        .badge-premium {
            background: linear-gradient(135deg, var(--ohs-premium-gold), #d97706);
            color: white;
        }

        /* Additional styling for simplified cart elements */
        #volumeDiscountBanner {
            animation: slideDown 0.5s ease-in-out;
            box-shadow: 0 4px 15px rgba(74, 222, 128, 0.3);
        }

        @keyframes slideDown {
            from { 
                opacity: 0; 
                transform: translateY(-20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        #volumePricingInfo {
            transition: all 0.3s ease;
        }

        #volumePricingInfo.show {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Enhanced cart item styling */
        .cart-item {
            transition: all 0.3s ease;
            border-radius: 12px;
            margin-bottom: 1rem;
            padding: 1.5rem;
        }

        .cart-item:hover {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        /* Volume discount text styling */
        #volumeDiscountText {
            font-weight: 600;
        }

        /* Improved empty cart styling */
        .empty-cart {
            background: linear-gradient(135deg, #f8fafc, #ffffff);
            border-radius: 15px;
            padding: 3rem 2rem;
            margin: 2rem 0;
        }

        .empty-cart .cert-badge {
            transition: transform 0.3s ease;
        }

        .empty-cart .cert-badge:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <!-- Navigation - Updated Structure -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="../index.html">
                <svg width="32" height="32" viewBox="0 0 400 250" class="me-2">
                    <rect width="400" height="250" fill="#2E5EAA"/>
                    <text x="200" y="180" text-anchor="middle" fill="#7DD3FC" font-family="Arial, sans-serif" font-size="100" font-weight="bold">OHS</text>
                    <text x="200" y="210" text-anchor="middle" fill="#7DD3FC" font-family="Arial, sans-serif" font-size="20">Organic HypoSolutions</text>
                    <path d="M 320 80 Q 340 60 360 80 Q 340 100 320 80" fill="#4ADE80"/>
                    <path d="M 330 70 Q 350 50 370 70 Q 350 90 330 70" fill="#22C55E"/>
                </svg>
                Organic HypoSolutions
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">
                            <i class="fas fa-home me-1"></i>Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../services.html">
                            <i class="fas fa-spray-can me-1"></i>Services
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../products.html">
                            <i class="fas fa-shopping-bag me-1"></i>Products
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../calculator.html">
                            <i class="fas fa-calculator me-1"></i>Calculator
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="../about.html" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-info-circle me-1"></i>About
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="../about.html">
                                <i class="fas fa-info-circle me-2"></i>About Us
                            </a></li>
                            <li><a class="dropdown-item" href="../science-certifications.html">
                                <i class="fas fa-microscope me-2"></i>Science & Certifications
                            </a></li>
                            <li><a class="dropdown-item" href="../contact.html">
                                <i class="fas fa-phone me-2"></i>Contact
                            </a></li>
                            <li><a class="dropdown-item" href="../legal-information.html">
                                <i class="fas fa-gavel me-2"></i>Legal Information
                            </a></li>
                        </ul>
                    </li>
                    
                    <!-- Customer Shopping & Account -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle fw-semibold" href="#" id="shopDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-shopping-cart me-1"></i>Shop
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item active" href="cart.html">
                                <i class="fas fa-shopping-cart me-2"></i>View Cart 
                                <span id="cartBadge" class="badge bg-danger ms-1" style="display: none;">0</span>
                            </a></li>
                            <li><a class="dropdown-item" href="checkout.html">
                                <i class="fas fa-credit-card me-2"></i>Checkout
                                <span class="construction-badge ms-1">Under Construction</span>
                            </a></li>
                            <li><a class="dropdown-item" href="book-service.html">
                                <i class="fas fa-calendar-plus me-2"></i>Book Service
                            </a></li>
                        </ul>
                    </li>
                    
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="accountDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user me-1"></i>Account
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="../account/profile.html">
                                <i class="fas fa-building me-2"></i>Business Pricing
                                <span class="construction-badge ms-1">Under Construction</span>
                            </a></li>
                            <li><a class="dropdown-item" href="../account/orders.html">
                                <i class="fas fa-user-circle me-2"></i>Consumer Pricing
                                <span class="construction-badge ms-1">Under Construction</span>
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="../auth/login.html">
                                <i class="fas fa-sign-in-alt me-2"></i>Login
                                <span class="construction-badge ms-1">Under Construction</span>
                            </a></li>
                            <li><a class="dropdown-item" href="../auth/register.html">
                                <i class="fas fa-user-plus me-2"></i>Register
                                <span class="construction-badge ms-1">Under Construction</span>
                            </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container text-center">
            <h1 class="display-4 fw-bold mb-3">Your Shopping Cart</h1>
            <p class="lead">Complete your order of premium USDA Certified Organic and EPA registered HOCl products</p>
            <div class="hero-stats">
                <div class="row text-center">
                    <div class="col-md-3 col-6 mb-3">
                        <div class="cert-badge">
                            <i class="fas fa-leaf me-2"></i>USDA Organic
                        </div>
                    </div>
                    <div class="col-md-3 col-6 mb-3">
                        <div class="cert-badge">
                            <i class="fas fa-shield-alt me-2"></i>EPA Registered
                        </div>
                    </div>
                    <div class="col-md-3 col-6 mb-3">
                        <div class="cert-badge">
                            <i class="fas fa-shipping-fast me-2"></i>FREE Shipping
                        </div>
                    </div>
                    <div class="col-md-3 col-6 mb-3">
                        <div class="cert-badge">
                            <i class="fas fa-percentage me-2"></i>Volume Discounts
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="cart-container p-4">
            <!-- Volume Discount Banner - Only shows when discounts are active -->
            <div id="volumeDiscountBanner" class="alert alert-success text-center mb-4" style="background: linear-gradient(135deg, var(--ohs-organic-green), var(--ohs-dark-green)); border: none; color: white; display: none;">
                <div class="d-flex align-items-center justify-content-center">
                    <i class="fas fa-percentage me-2 fs-4"></i>
                    <div>
                        <strong>Volume Discounts Applied!</strong> <span id="volumeDiscountText">You're saving with bulk pricing</span>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- Cart Items -->
                <div class="col-lg-8">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3 class="mb-0">
                            <i class="fas fa-shopping-cart me-2 text-primary"></i>Shopping Cart
                        </h3>
                        <div class="d-flex gap-3 align-items-center">
                            <small class="text-muted" id="itemCount">0 items</small>
                            <button class="btn btn-outline-danger btn-sm" onclick="clearAllItems()">
                                <i class="fas fa-trash me-1"></i>Clear All
                            </button>
                        </div>
                    </div>

                    <!-- Cart Items Container -->
                    <div id="cartItems">
                        <!-- Items will be dynamically inserted here -->
                    </div>

                    <!-- Empty Cart Message -->
                    <div id="emptyCart" class="empty-cart">
                        <i class="fas fa-shopping-cart text-muted"></i>
                        <h4 class="mt-3 mb-3">Your cart is empty</h4>
                        <p class="text-muted mb-4">Browse our USDA Certified Organic and EPA registered products!</p>
                        <div class="d-flex flex-column flex-sm-row gap-3 justify-content-center">
                            <a href="../products.html" class="btn btn-primary btn-lg">
                                <i class="fas fa-shopping-bag me-2"></i>Browse Products
                            </a>
                            <a href="../services.html" class="btn btn-outline-primary btn-lg">
                                <i class="fas fa-spray-can me-2"></i>View Services
                            </a>
                        </div>
                        <div class="mt-4">
                            <div class="row text-center">
                                <div class="col-6 col-md-3 mb-3">
                                    <div class="d-flex flex-column align-items-center">
                                        <div class="cert-badge bg-success text-white mb-2">
                                            <i class="fas fa-leaf"></i>
                                        </div>
                                        <small class="text-muted">19 Organic Products</small>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3 mb-3">
                                    <div class="d-flex flex-column align-items-center">
                                        <div class="cert-badge bg-warning text-white mb-2">
                                            <i class="fas fa-crown"></i>
                                        </div>
                                        <small class="text-muted">38 Premium Products</small>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3 mb-3">
                                    <div class="d-flex flex-column align-items-center">
                                        <div class="cert-badge bg-primary text-white mb-2">
                                            <i class="fas fa-shipping-fast"></i>
                                        </div>
                                        <small class="text-muted">Free Shipping</small>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3 mb-3">
                                    <div class="d-flex flex-column align-items-center">
                                        <div class="cert-badge bg-info text-white mb-2">
                                            <i class="fas fa-percentage"></i>
                                        </div>
                                        <small class="text-muted">Volume Discounts</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Product Recommendations (when cart has items) -->
                    <div id="recommendations" style="display: none;" class="mt-4">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">
                                    <i class="fas fa-lightbulb me-2 text-warning"></i>You might also like
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <div class="d-flex align-items-center">
                                            <div class="product-image organic me-3" style="width: 60px; height: 60px; font-size: 1.5rem;">
                                                🧴
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-1">32oz Organic Multi-Surface Cleaner</h6>
                                                <p class="small text-muted mb-1">Perfect for daily cleaning</p>
                                                <div class="price-display">$21.80</div>
                                                <div class="d-flex align-items-center gap-2 mt-2">
                                                    <div class="recommendation-quantity-controls">
                                                        <button class="quantity-btn-sm" onclick="changeRecommendationQuantity('rec1', -1)" 
                                                                id="rec1-minus" disabled>
                                                            <i class="fas fa-minus"></i>
                                                        </button>
                                                        <input type="number" class="quantity-input-sm" value="1" 
                                                               min="1" max="999" id="rec1-qty"
                                                               onchange="setRecommendationQuantity('rec1', this.value)"
                                                               onclick="this.select()">
                                                        <button class="quantity-btn-sm" onclick="changeRecommendationQuantity('rec1', 1)">
                                                            <i class="fas fa-plus"></i>
                                                        </button>
                                                    </div>
                                                    <button class="btn btn-sm btn-success" onclick="addRecommendationToCart('rec1')">
                                                        <i class="fas fa-cart-plus me-1"></i>Add
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <div class="d-flex align-items-center">
                                            <div class="product-image premium me-3" style="width: 60px; height: 60px; font-size: 1.5rem;">
                                                🧽
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-1">Professional Disinfecting Wipes</h6>
                                                <p class="small text-muted mb-1">EPA registered for commercial use</p>
                                                <div class="price-display">$28.45</div>
                                                <div class="d-flex align-items-center gap-2 mt-2">
                                                    <div class="recommendation-quantity-controls">
                                                        <button class="quantity-btn-sm" onclick="changeRecommendationQuantity('rec2', -1)" 
                                                                id="rec2-minus" disabled>
                                                            <i class="fas fa-minus"></i>
                                                        </button>
                                                        <input type="number" class="quantity-input-sm" value="1" 
                                                               min="1" max="999" id="rec2-qty"
                                                               onchange="setRecommendationQuantity('rec2', this.value)"
                                                               onclick="this.select()">
                                                        <button class="quantity-btn-sm" onclick="changeRecommendationQuantity('rec2', 1)">
                                                            <i class="fas fa-plus"></i>
                                                        </button>
                                                    </div>
                                                    <button class="btn btn-sm btn-success" onclick="addRecommendationToCart('rec2')">
                                                        <i class="fas fa-cart-plus me-1"></i>Add
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="col-lg-4">
                    <div class="order-summary">
                        <h4>
                            <i class="fas fa-receipt me-2"></i>Order Summary
                        </h4>
                        
                        <div class="summary-row">
                            <span>Subtotal:</span>
                            <span id="subtotal">$0.00</span>
                        </div>
                        <div class="summary-row">
                            <span>Volume Discounts:</span>
                            <span id="volumeDiscount" class="discount-text">$0.00</span>
                        </div>
                        <div class="summary-row">
                            <span>Shipping:</span>
                            <span id="shipping" class="free-shipping">FREE</span>
                        </div>
                        <div class="summary-row">
                            <span>Utah Tax (7.75%):</span>
                            <span id="tax">$0.00</span>
                        </div>
                        <!-- Subscription discount row will be added dynamically -->
                        <div class="summary-row">
                            <span><strong>Total:</strong></span>
                            <span id="total"><strong>$0.00</strong></span>
                        </div>

                        <!-- Volume Pricing Info - Simplified -->
                        <div id="volumePricingInfo" class="mt-4 p-3 rounded" style="background: rgba(74, 222, 128, 0.1); border: 2px solid var(--ohs-organic-green); display: none;">
                            <h6 class="text-success mb-2">
                                <i class="fas fa-info-circle me-2"></i>Volume Discounts Available
                            </h6>
                            <div class="small text-success">
                                Each product has quantity-based discounts. Add more items to unlock savings!
                            </div>
                        </div>

                        <!-- Coupon Code -->
                        <div class="mt-4">
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="Enter coupon code" id="couponCode">
                                <button class="btn btn-outline-secondary" onclick="applyCoupon()">Apply</button>
                            </div>
                            <small class="text-muted d-block mt-2">
                                <span class="construction-badge">Shopify Discount API Ready</span>
                            </small>
                        </div>

                        <!-- Subscription Option -->
                        <div class="mt-4 p-3 rounded" style="background: rgba(46, 94, 170, 0.1); border: 2px solid var(--ohs-primary-blue);">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="subscriptionToggle">
                                <label class="form-check-label" for="subscriptionToggle">
                                    <strong class="text-primary">Subscribe & Save 8%</strong>
                                </label>
                            </div>
                            <small class="text-muted d-block mt-1">
                                <i class="fas fa-calendar-alt me-1"></i>
                                Monthly delivery • Switch to quarterly for 10% savings
                                <span class="construction-badge ms-2">Under Construction</span>
                            </small>
                            <div class="mt-2">
                                <select class="form-select form-select-sm" id="subscriptionFrequency" disabled>
                                    <option value="monthly">Monthly (8% discount)</option>
                                    <option value="quarterly">Quarterly (10% discount)</option>
                                </select>
                            </div>
                        </div>

                        <!-- Checkout Button -->
                        <button class="btn btn-primary w-100 btn-lg btn-checkout mt-4" onclick="proceedToCheckout()">
                            <i class="fas fa-lock me-2"></i>Secure Checkout
                        </button>
                        
                        <!-- Security & Integration Info -->
                        <div class="text-center mt-3">
                            <small class="text-muted d-block">
                                <i class="fas fa-shield-alt me-1"></i>256-bit SSL encryption
                            </small>
                            <div class="mt-2">
                                <span class="construction-badge">Shopify Payments Ready</span>
                            </div>
                        </div>

                        <!-- Delivery Information - Simplified -->
                        <div class="mt-4 p-3 rounded bg-light">
                            <h6 class="mb-2">
                                <i class="fas fa-truck me-2 text-primary"></i>Shipping Information
                            </h6>
                            <div class="small">
                                <div class="d-flex justify-content-between mb-1">
                                    <span>Standard Shipping:</span>
                                    <span class="free-shipping">FREE</span>
                                </div>
                                <div class="text-muted">
                                    <i class="fas fa-map-marker-alt me-1"></i>
                                    Ships from Salt Lake City, UT
                                </div>
                                <div class="mt-2">
                                    <span class="construction-badge">ShipRight Integration</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer - Updated to match reference structure with PROPER STYLING -->
    <footer class="footer-section">
        <div class="container">
            <div class="row">
                <div class="col-md-3 mb-4">
                    <div class="d-flex align-items-center mb-3">
                        <svg width="40" height="40" viewBox="0 0 400 250" class="me-2">
                            <rect width="400" height="250" fill="#2E5EAA"/>
                            <text x="200" y="180" text-anchor="middle" fill="#7DD3FC" font-family="Arial, sans-serif" font-size="100" font-weight="bold">OHS</text>
                            <text x="200" y="210" text-anchor="middle" fill="#7DD3FC" font-family="Arial, sans-serif" font-size="20">Organic HypoSolutions</text>
                            <path d="M 320 80 Q 340 60 360 80 Q 340 100 320 80" fill="#4ADE80"/>
                            <path d="M 330 70 Q 350 50 370 70 Q 350 90 330 70" fill="#22C55E"/>
                        </svg>
                        <h5 class="mb-0">Organic HypoSolutions</h5>
                    </div>
                    <p>Utah's dual-certified HOCl distributor for families and businesses.</p>
                </div>
                
                <div class="col-md-2 mb-4">
                    <h6 class="fw-bold mb-3">Products</h6>
                    <ul class="list-unstyled">
                        <li><a href="../products.html" class="text-white-50 text-decoration-none">USDA Organic (19)</a></li>
                        <li><a href="../products.html" class="text-white-50 text-decoration-none">EPA Premium (38)</a></li>
                        <li><a href="../products.html" class="text-white-50 text-decoration-none">Bulk Solutions</a></li>
                        <li><a href="../products.html" class="text-white-50 text-decoration-none">All Products</a></li>
                    </ul>
                </div>
                
                <div class="col-md-2 mb-4">
                    <h6 class="fw-bold mb-3">Certified</h6>
                    <ul class="list-unstyled">
                        <li><span class="footer-cert">USDA Organic</span></li>
                        <li><span class="footer-cert">EPA Registered</span></li>
                        <li><span class="footer-cert">FDA Food Safe</span></li>
                    </ul>
                </div>
                
                <div class="col-md-2 mb-4">
                    <h6 class="fw-bold mb-3">Support</h6>
                    <ul class="list-unstyled">
                        <li><a href="../science-certifications.html" class="text-white-50 text-decoration-none">Science</a></li>
                        <li><a href="../calculator.html" class="text-white-50 text-decoration-none">Calculator</a></li>
                        <li><a href="../about.html" class="text-white-50 text-decoration-none">About</a></li>
                        <li><a href="../contact.html" class="text-white-50 text-decoration-none">Contact</a></li>
                    </ul>
                </div>
                
                <div class="col-md-3 mb-4">
                    <h6 class="fw-bold mb-3">Contact</h6>
                    <p class="mb-2">
                        <i class="fas fa-phone me-2"></i>
                        <a href="tel:+18017125663" class="text-white text-decoration-none">(801) 712-5663</a>
                    </p>
                    <p class="mb-2">
                        <i class="fas fa-envelope me-2"></i>
                        <a href="mailto:ohshocl@gmail.com" class="text-white text-decoration-none">ohshocl@gmail.com</a>
                    </p>
                    <p class="mb-3">
                        <i class="fas fa-map-marker-alt me-2"></i>
                        Salt Lake City, UT, USA
                    </p>
                </div>
            </div>
            
            <hr class="my-4 border-white-50">
            
            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="mb-0">&copy; 2025 Organic HypoSolutions. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <span class="footer-cert me-1">57 Products</span>
                    <span class="footer-cert me-1">FREE Ship</span>
                    <span class="footer-cert">Cart Ready</span>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- FIXED CART SYSTEM - Complete Rewrite -->
    <script>
        // Global cart variables with improved initialization
        let cartItems = [];
        let isCartSystemReady = false;
        
        // CRITICAL FIX: Improved cart loading
        function loadCart() {
            try {
                const stored = localStorage.getItem('ohsCart');
                if (stored) {
                    cartItems = JSON.parse(stored);
                    // Ensure all items have required properties
                    cartItems = cartItems.map(item => ({
                        productId: item.productId || `item_${Date.now()}_${Math.random()}`,
                        name: item.name || 'Unknown Product',
                        price: parseFloat(item.price) || 0,
                        quantity: parseInt(item.quantity) || 1,
                        type: item.type || item.productLine || 'organic',
                        description: item.description || 'No description available',
                        emoji: item.emoji || (item.type === 'premium' ? '👑' : '🌱'),
                        size: item.size || '',
                        sku: item.sku || '',
                        volumeDiscounts: item.volumeDiscounts || null,
                        ...item // Keep any additional properties
                    }));
                } else {
                    cartItems = [];
                }
                console.log('✅ Cart loaded:', cartItems.length, 'items');
                
                // Add some test items if cart is empty (for testing)
                if (cartItems.length === 0 && window.location.search.includes('test=true')) {
                    addTestItems();
                }
                
            } catch (error) {
                console.error('❌ Error loading cart:', error);
                cartItems = [];
            }
            updateDisplay();
            isCartSystemReady = true;
        }
        
        // Add test items for demonstration
        function addTestItems() {
            cartItems = [
                {
                    productId: 'test_organic_1',
                    name: '32oz Organic Multi-Surface Cleaner',
                    price: 21.80,
                    quantity: 23,
                    type: 'organic',
                    description: 'USDA Certified Organic hypochlorous acid solution for safe daily cleaning',
                    emoji: '🧴',
                    size: '32oz',
                    sku: 'OHS-ORG-32-MS',
                    volumeDiscounts: {
                        '12+': { discount: 0.05, description: '5% off 12+' },
                        '24+': { discount: 0.10, description: '10% off 24+' }
                    }
                },
                {
                    productId: 'test_premium_1',
                    name: 'Professional Surface Disinfectant',
                    price: 16.13,
                    quantity: 50,
                    type: 'premium',
                    description: 'EPA registered commercial-grade disinfectant for professional use',
                    emoji: '🏭',
                    size: '32oz',
                    sku: 'OHS-PRE-32-SD',
                    volumeDiscounts: {
                        '25+': { discount: 0.08, description: '8% off 25+' },
                        '50+': { discount: 0.15, description: '15% off 50+' }
                    }
                },
                {
                    productId: 'test_premium_2',
                    name: 'Industrial Floor Cleaner',
                    price: 24.99,
                    quantity: 3,
                    type: 'premium',
                    description: 'Heavy-duty floor cleaning solution for commercial facilities',
                    emoji: '🧽',
                    size: '1 Gallon',
                    sku: 'OHS-PRE-GAL-FC'
                }
            ];
            saveCart();
        }
        
        // CRITICAL FIX: Improved cart saving
        function saveCart() {
            try {
                localStorage.setItem('ohsCart', JSON.stringify(cartItems));
                console.log('💾 Cart saved successfully');
                // Broadcast update to other pages
                window.dispatchEvent(new StorageEvent('storage', {
                    key: 'ohsCart',
                    newValue: JSON.stringify(cartItems)
                }));
            } catch (error) {
                console.error('❌ Error saving cart:', error);
            }
        }
        
        // CRITICAL FIX: Comprehensive display update
        function updateDisplay() {
            updateCartItems();
            updateOrderSummary();
            updateCartBadge();
            updateItemCount();
            updateVolumeDiscountDisplay();
            updateRecommendations();
        }
        
        // CRITICAL FIX: Complete cart items display rewrite
        function updateCartItems() {
            const container = document.getElementById('cartItems');
            const emptyCart = document.getElementById('emptyCart');
            
            if (!container || !emptyCart) {
                console.error('❌ Cart container elements not found');
                return;
            }
            
            if (cartItems.length === 0) {
                container.style.display = 'none';
                emptyCart.style.display = 'block';
                return;
            }
            
            container.style.display = 'block';
            emptyCart.style.display = 'none';
            
            let html = '';
            cartItems.forEach((item, index) => {
                const productType = item.type || 'organic';
                const isOrganic = productType === 'organic';
                
                html += `
                    <div class="cart-item" data-index="${index}">
                        <div class="row align-items-center">
                            <div class="col-md-2 col-3 mb-3 mb-md-0">
                                <div class="product-image ${isOrganic ? 'organic' : 'premium'}">
                                    ${item.emoji || (isOrganic ? '🌱' : '👑')}
                                </div>
                            </div>
                            <div class="col-md-4 col-9 mb-3 mb-md-0">
                                <h6 class="fw-bold mb-2">${item.name || 'Product Name'}</h6>
                                <p class="text-muted small mb-2">${item.description || 'Product description'}</p>
                                <div class="mb-2">
                                    <span class="badge ${isOrganic ? 'badge-organic' : 'badge-premium'}">
                                        ${isOrganic ? 'USDA Organic' : 'EPA Premium'}
                                    </span>
                                    ${item.size ? `<span class="badge bg-secondary ms-1">${item.size}</span>` : ''}
                                    ${item.sku ? `<span class="badge bg-info ms-1">${item.sku}</span>` : ''}
                                </div>
                                ${getVolumeDiscountBadge(item)}
                            </div>
                            <div class="col-md-3 col-12 mb-3 mb-md-0">
                                <div class="quantity-controls">
                                    <button class="quantity-btn" onclick="changeQuantity(${index}, -1)" 
                                            ${item.quantity <= 1 ? 'disabled' : ''} 
                                            title="Decrease quantity">
                                        <i class="fas fa-minus"></i>
                                    </button>
                                    <input type="number" class="quantity-input" value="${item.quantity}" 
                                           min="1" max="999" 
                                           onchange="setQuantity(${index}, this.value)"
                                           onclick="this.select()" 
                                           title="Enter quantity directly">
                                    <button class="quantity-btn" onclick="changeQuantity(${index}, 1)" 
                                            title="Increase quantity">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-2 col-6 text-center">
                                <div class="price-display">$${item.price.toFixed(2)}</div>
                                <small class="text-muted">each</small>
                            </div>
                            <div class="col-md-1 col-6 text-center">
                                <div class="price-display mb-2">$${(item.price * item.quantity).toFixed(2)}</div>
                                <button class="btn btn-sm btn-outline-danger" onclick="removeItem(${index})" 
                                        title="Remove item">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            console.log('✅ Cart items display updated with', cartItems.length, 'items');
        }
        
        // Helper function for volume discount badges
        function getVolumeDiscountBadge(item) {
            if (!item.volumeDiscounts) return '';
            
            let badgeHtml = '';
            for (const [threshold, discountInfo] of Object.entries(item.volumeDiscounts)) {
                const thresholdNum = parseInt(threshold.replace('+', ''));
                if (item.quantity >= thresholdNum) {
                    const savings = Math.round(discountInfo.discount * 100);
                    badgeHtml = `<div class="mt-1"><span class="badge bg-success">
                        <i class="fas fa-percentage me-1"></i>Saving ${savings}% (${discountInfo.description})
                    </span></div>`;
                    break;
                }
            }
            return badgeHtml;
        }
        
        // CRITICAL FIX: Improved order summary calculation
        function updateOrderSummary() {
            let subtotal = 0;
            let totalVolumeDiscount = 0;
            
            // Calculate subtotal and volume discounts
            cartItems.forEach(item => {
                const itemSubtotal = item.price * item.quantity;
                subtotal += itemSubtotal;
                
                // Check for volume discounts
                if (item.volumeDiscounts) {
                    for (const [threshold, discountInfo] of Object.entries(item.volumeDiscounts)) {
                        const thresholdNum = parseInt(threshold.replace('+', ''));
                        if (item.quantity >= thresholdNum) {
                            totalVolumeDiscount += itemSubtotal * discountInfo.discount;
                            break;
                        }
                    }
                }
            });
            
            const discountedSubtotal = subtotal - totalVolumeDiscount;
            const tax = discountedSubtotal * 0.0775; // Utah tax rate
            let total = discountedSubtotal + tax;
            
            // Apply subscription discount if enabled
            const subscriptionToggle = document.getElementById('subscriptionToggle');
            const subscriptionFrequency = document.getElementById('subscriptionFrequency');
            let subscriptionDiscount = 0;
            
            if (subscriptionToggle && subscriptionToggle.checked) {
                const frequency = subscriptionFrequency ? subscriptionFrequency.value : 'monthly';
                subscriptionDiscount = total * (frequency === 'quarterly' ? 0.10 : 0.08);
                total -= subscriptionDiscount;
            }
            
            // Update display elements with error checking
            const elements = {
                'subtotal': '$' + subtotal.toFixed(2),
                'volumeDiscount': totalVolumeDiscount > 0 ? '-$' + totalVolumeDiscount.toFixed(2) : '$0.00',
                'tax': '$' + tax.toFixed(2),
                'total': '$' + total.toFixed(2)
            };
            
            for (const [id, value] of Object.entries(elements)) {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = value;
                } else {
                    console.warn(`⚠️ Element ${id} not found`);
                }
            }
            
            // Update subscription discount display
            updateSubscriptionDiscountDisplay(subscriptionDiscount, subscriptionFrequency?.value || 'monthly');
            
            console.log('✅ Order summary updated - Subtotal:', subtotal.toFixed(2), 'Total:', total.toFixed(2));
        }
        
        // Update subscription discount display
        function updateSubscriptionDiscountDisplay(subscriptionDiscount, frequency) {
            // Remove existing subscription discount row
            const existingRow = document.querySelector('.subscription-discount-row');
            if (existingRow) existingRow.remove();
            
            if (subscriptionDiscount > 0) {
                const taxRow = document.getElementById('tax')?.closest('.summary-row');
                if (taxRow) {
                    const subscriptionRow = document.createElement('div');
                    subscriptionRow.className = 'summary-row subscription-discount-row';
                    subscriptionRow.innerHTML = `
                        <span>Subscription (${frequency === 'quarterly' ? '10%' : '8%'}):</span>
                        <span class="discount-text">-$${subscriptionDiscount.toFixed(2)}</span>
                    `;
                    taxRow.parentNode.insertBefore(subscriptionRow, taxRow.nextSibling);
                }
            }
        }
        
        // Update volume discount banner display
        function updateVolumeDiscountDisplay() {
            const banner = document.getElementById('volumeDiscountBanner');
            const bannerText = document.getElementById('volumeDiscountText');
            const pricingInfo = document.getElementById('volumePricingInfo');
            
            let hasVolumeDiscounts = false;
            let discountCount = 0;
            
            cartItems.forEach(item => {
                if (item.volumeDiscounts) {
                    for (const [threshold, discountInfo] of Object.entries(item.volumeDiscounts)) {
                        const thresholdNum = parseInt(threshold.replace('+', ''));
                        if (item.quantity >= thresholdNum) {
                            hasVolumeDiscounts = true;
                            discountCount++;
                            break;
                        }
                    }
                }
            });
            
            if (hasVolumeDiscounts && banner && bannerText) {
                banner.style.display = 'block';
                bannerText.textContent = discountCount === 1 ? 
                    'You\'re saving with volume pricing on 1 product!' :
                    `You're saving with volume pricing on ${discountCount} products!`;
            } else if (banner) {
                banner.style.display = 'none';
            }
            
            // Show/hide volume pricing info for empty cart
            if (pricingInfo) {
                pricingInfo.style.display = cartItems.length === 0 ? 'block' : 'none';
            }
        }
        
        // Update recommendations display
        function updateRecommendations() {
            const recommendations = document.getElementById('recommendations');
            if (recommendations) {
                recommendations.style.display = cartItems.length > 0 ? 'block' : 'none';
            }
        }
        
        // CRITICAL FIX: Cart management functions with improved error handling
        function updateCartBadge() {
            const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);
            const badge = document.getElementById('cartBadge');
            if (badge) {
                badge.style.display = totalItems > 0 ? 'inline-block' : 'none';
                badge.textContent = totalItems;
            }
        }
        
        function updateItemCount() {
            const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);
            const itemCount = document.getElementById('itemCount');
            if (itemCount) {
                itemCount.textContent = totalItems === 1 ? '1 item' : totalItems + ' items';
            }
        }
        
        // CRITICAL FIX: Main quantity change function
        function changeQuantity(index, change) {
            console.log('🔄 Changing quantity for item', index, 'by', change);
            
            if (!cartItems[index]) {
                console.error('❌ Item not found at index', index);
                return;
            }
            
            const newQuantity = cartItems[index].quantity + change;
            
            if (newQuantity <= 0) {
                // Remove item if quantity becomes 0 or negative
                if (confirm(`Remove "${cartItems[index].name}" from cart?`)) {
                    cartItems.splice(index, 1);
                    console.log('🗑️ Item removed from cart');
                }
            } else {
                cartItems[index].quantity = newQuantity;
                console.log('✅ Quantity updated to', newQuantity);
            }
            
            saveCart();
            updateDisplay();
        }

        // NEW: Set quantity directly from input field
        function setQuantity(index, value) {
            console.log('📝 Setting quantity for item', index, 'to', value);
            
            if (!cartItems[index]) {
                console.error('❌ Item not found at index', index);
                return;
            }
            
            const newQuantity = parseInt(value) || 1;
            const clampedQuantity = Math.max(1, Math.min(999, newQuantity));
            
            if (newQuantity !== clampedQuantity) {
                console.log('⚠️ Quantity clamped from', newQuantity, 'to', clampedQuantity);
            }
            
            cartItems[index].quantity = clampedQuantity;
            console.log('✅ Quantity set to', clampedQuantity);
            
            saveCart();
            updateDisplay();
        }

        // NEW: Recommendation product quantity management
        let recommendationQuantities = {
            'rec1': 1,
            'rec2': 1
        };

        function changeRecommendationQuantity(recId, change) {
            const newQuantity = recommendationQuantities[recId] + change;
            const clampedQuantity = Math.max(1, Math.min(999, newQuantity));
            
            recommendationQuantities[recId] = clampedQuantity;
            
            // Update the input field
            const input = document.getElementById(recId + '-qty');
            if (input) input.value = clampedQuantity;
            
            // Update minus button state
            const minusBtn = document.getElementById(recId + '-minus');
            if (minusBtn) minusBtn.disabled = clampedQuantity <= 1;
            
            console.log('🔄 Recommendation', recId, 'quantity changed to', clampedQuantity);
        }

        function setRecommendationQuantity(recId, value) {
            const newQuantity = parseInt(value) || 1;
            const clampedQuantity = Math.max(1, Math.min(999, newQuantity));
            
            recommendationQuantities[recId] = clampedQuantity;
            
            // Update the input field in case it was clamped
            const input = document.getElementById(recId + '-qty');
            if (input) input.value = clampedQuantity;
            
            // Update minus button state
            const minusBtn = document.getElementById(recId + '-minus');
            if (minusBtn) minusBtn.disabled = clampedQuantity <= 1;
            
            console.log('📝 Recommendation', recId, 'quantity set to', clampedQuantity);
        }

        function addRecommendationToCart(recId) {
            const quantity = recommendationQuantities[recId] || 1;
            let productData;
            
            if (recId === 'rec1') {
                productData = {
                    productId: 'rec_organic_cleaner',
                    name: '32oz Organic Multi-Surface Cleaner',
                    price: 21.80,
                    quantity: quantity,
                    type: 'organic',
                    description: 'Perfect for daily cleaning',
                    emoji: '🧴',
                    size: '32oz',
                    sku: 'OHS-ORG-32-MS'
                };
            } else if (recId === 'rec2') {
                productData = {
                    productId: 'rec_premium_wipes',
                    name: 'Professional Disinfecting Wipes',
                    price: 28.45,
                    quantity: quantity,
                    type: 'premium',
                    description: 'EPA registered for commercial use',
                    emoji: '🧽',
                    size: 'Container',
                    sku: 'OHS-PRE-WIPES'
                };
            }
            
            if (productData) {
                addToCart(productData);
                console.log('✅ Added recommendation to cart:', productData.name, 'x' + quantity);
                
                // Reset recommendation quantity
                recommendationQuantities[recId] = 1;
                const input = document.getElementById(recId + '-qty');
                if (input) input.value = 1;
                const minusBtn = document.getElementById(recId + '-minus');
                if (minusBtn) minusBtn.disabled = true;
                
                // Show success feedback
                const addBtn = event.target.closest('button');
                if (addBtn) {
                    const originalText = addBtn.innerHTML;
                    addBtn.innerHTML = '<i class="fas fa-check me-1"></i>Added!';
                    addBtn.classList.add('btn-outline-success');
                    addBtn.classList.remove('btn-success');
                    setTimeout(() => {
                        addBtn.innerHTML = originalText;
                        addBtn.classList.remove('btn-outline-success');
                        addBtn.classList.add('btn-success');
                    }, 1500);
                }
            }
        }
        
        function removeItem(index) {
            console.log('🗑️ Removing item at index', index);
            
            if (!cartItems[index]) {
                console.error('❌ Item not found at index', index);
                return;
            }
            
            if (confirm(`Remove "${cartItems[index].name}" from cart?`)) {
                cartItems.splice(index, 1);
                saveCart();
                updateDisplay();
                console.log('✅ Item removed successfully');
            }
        }
        
        function clearAllItems() {
            if (cartItems.length === 0) {
                alert('Your cart is already empty!');
                return;
            }
            
            if (confirm(`Clear all ${cartItems.length} items from cart?`)) {
                cartItems = [];
                saveCart();
                updateDisplay();
                console.log('🧹 Cart cleared');
            }
        }
        
        // Add item from products page
        function addToCart(productData) {
            console.log('➕ Adding to cart:', productData);
            
            if (!productData || !productData.name || !productData.price) {
                console.error('❌ Invalid product data');
                return;
            }
            
            const existingIndex = cartItems.findIndex(item => 
                (item.productId && item.productId === productData.productId) || 
                (item.name === productData.name && item.size === productData.size)
            );
            
            if (existingIndex >= 0) {
                cartItems[existingIndex].quantity += productData.quantity || 1;
                console.log('✅ Updated existing item quantity');
            } else {
                cartItems.push({
                    productId: productData.productId || `item_${Date.now()}_${Math.random()}`,
                    name: productData.name,
                    price: parseFloat(productData.price),
                    quantity: productData.quantity || 1,
                    type: productData.type || productData.productLine || 'organic',
                    description: productData.description || 'No description available',
                    emoji: productData.emoji || (productData.type === 'premium' ? '👑' : '🌱'),
                    size: productData.size || '',
                    sku: productData.sku || '',
                    volumeDiscounts: productData.volumeDiscounts || null,
                    ...productData
                });
                console.log('✅ Added new item to cart');
            }
            
            saveCart();
            updateDisplay();
        }
        
        // Subscription handlers
        function handleSubscriptionToggle() {
            const toggle = document.getElementById('subscriptionToggle');
            const frequency = document.getElementById('subscriptionFrequency');
            
            if (toggle && frequency) {
                toggle.addEventListener('change', function() {
                    frequency.disabled = !this.checked;
                    updateDisplay();
                    console.log('🔄 Subscription toggled:', this.checked);
                });
                
                frequency.addEventListener('change', function() {
                    if (toggle.checked) {
                        updateDisplay();
                        console.log('🔄 Subscription frequency changed:', this.value);
                    }
                });
            }
        }
        
        // Utility functions
        function applyCoupon() {
            const code = document.getElementById('couponCode')?.value;
            if (!code || !code.trim()) {
                alert('Please enter a coupon code');
                return;
            }
            alert(`Coupon "${code.trim()}" will be applied at Shopify checkout`);
            console.log('🎫 Coupon code entered:', code.trim());
        }
        
        function proceedToCheckout() {
            if (cartItems.length === 0) {
                alert('Your cart is empty! Add some products first.');
                return;
            }
            
            const subtotal = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const checkoutData = {
                items: cartItems,
                subtotal: subtotal,
                timestamp: new Date().toISOString(),
                customerNote: 'Cart from OHS website'
            };
            
            try {
                localStorage.setItem('ohsCheckout', JSON.stringify(checkoutData));
                console.log('💳 Proceeding to checkout with', cartItems.length, 'items');
                window.location.href = 'checkout.html';
            } catch (error) {
                console.error('❌ Error saving checkout data:', error);
                alert('Error preparing checkout. Please try again.');
            }
        }
        
        // Debug functions for testing
        function debugCart() {
            console.log('🐛 Current cart state:');
            console.log('Items:', cartItems);
            console.log('System ready:', isCartSystemReady);
            console.log('LocalStorage:', localStorage.getItem('ohsCart'));
        }
        
        function addSampleItem() {
            const sampleItem = {
                productId: `sample_${Date.now()}`,
                name: 'Sample Product',
                price: 15.99,
                quantity: 1,
                type: 'organic',
                description: 'This is a sample product for testing',
                emoji: '🧪',
                size: '16oz',
                sku: 'SAMPLE-001'
            };
            addToCart(sampleItem);
        }
        
        // Expose functions globally for HTML onclick handlers
        window.addToCart = addToCart;
        window.changeQuantity = changeQuantity;
        window.setQuantity = setQuantity;
        window.changeRecommendationQuantity = changeRecommendationQuantity;
        window.setRecommendationQuantity = setRecommendationQuantity;
        window.addRecommendationToCart = addRecommendationToCart;
        window.removeItem = removeItem;
        window.clearAllItems = clearAllItems;
        window.applyCoupon = applyCoupon;
        window.proceedToCheckout = proceedToCheckout;
        window.debugCart = debugCart;
        window.addSampleItem = addSampleItem;
        
        // Initialize cart system
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Cart page initializing...');
            loadCart();
            handleSubscriptionToggle();
            
            // Add test items button for debugging
            if (window.location.search.includes('debug=true')) {
                const testButton = document.createElement('button');
                testButton.textContent = 'Add Sample Item';
                testButton.className = 'btn btn-warning btn-sm';
                testButton.onclick = addSampleItem;
                document.querySelector('.cart-container').prepend(testButton);
                
                const debugButton = document.createElement('button');
                debugButton.textContent = 'Debug Cart';
                debugButton.className = 'btn btn-info btn-sm ms-2';
                debugButton.onclick = debugCart;
                document.querySelector('.cart-container').prepend(debugButton);
            }
            
            console.log('✅ Cart page ready! Cart has', cartItems.length, 'items');
        });
        
        // Listen for cart updates from other pages
        window.addEventListener('storage', function(e) {
            if (e.key === 'ohsCart') {
                console.log('📢 Cart updated from another page, reloading...');
                loadCart();
            }
        });
        
        // Error handling for global errors
        window.addEventListener('error', function(e) {
            console.error('❌ JavaScript error:', e.error);
        });
        
        console.log('✅ Fixed cart system loaded and ready!');
    </script>
</body>
</html>
