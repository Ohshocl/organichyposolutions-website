<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Enhanced SEO -->
    <title>Professional HOCl Products - EPA Certified & USDA Organic | Organic HypoSolutions</title>
    <meta name="description" content="Complete catalog of EPA certified disinfectant products and USDA organic cleaning solutions. Professional hypochlorous acid products for commercial, healthcare, and family use. Utah manufactured with free shipping on Qualified Orders.">
    <meta name="keywords" content="EPA certified disinfectant products, USDA organic cleaning solutions, professional hypochlorous acid products, family safe organic cleaners, commercial disinfectant supplies">
    
    <!-- SEO & Business Info -->
    <meta name="author" content="Organic HypoSolutions">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://organichyposolutions.com/products.html">
    <meta name="geo.region" content="US-UT">
    <meta name="business.phone" content="+1-801-712-5663">
    <meta name="business.email" content="OHS@OrganicHypoSolutions.com">

    <!-- Social Sharing -->
    <meta property="og:title" content="Professional HOCl Products - EPA Certified & USDA Organic">
    <meta property="og:description" content="Complete catalog of EPA certified disinfectant products and USDA organic cleaning solutions.">
    <meta property="og:url" content="https://organichyposolutions.com/products.html">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://organichyposolutions.com/images/ohs-products-catalog-social.jpg">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HEKE217WEY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-HEKE217WEY');
    </script>
    
    <!-- Bootstrap & FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --ohs-primary-blue: #2E5EAA;
            --ohs-accent-blue: #7DD3FC;
            --ohs-organic-green: #4ADE80;
            --ohs-dark-green: #22C55E;
            --ohs-premium-gold: #f59e0b;
            --ohs-light-gray: #f8f9fa;
            --ohs-dark-gray: #6c757d;
            --primary-blue: #2E5EAA;
            --secondary-blue: #7DD3FC;
            --success-green: #22C55E;
            --accent-green: #4ADE80;
            --premium-gold: #f59e0b;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-600: #4b5563;
        }

        /* EXACT NAVBAR STYLING FROM ORIGINAL */
        .navbar {
            background-color: #2E5EAA !important;
            padding: 0.3rem 0 !important;
            box-shadow: none !important;
            min-height: 80px !important;
        }

        .navbar-brand {
            color: white !important;
            font-size: 1.5rem !important;
            font-weight: bold !important;
            padding: 0.2rem 0 !important;
            display: flex !important;
            align-items: center !important;
        }

        .navbar-brand img {
            height: 60px !important;
            width: auto !important;
            margin-right: 0.5rem !important;
        }

        .navbar-nav .nav-link {
            color: white !important;
            font-weight: 500 !important;
            padding: 0.5rem 1rem !important;
            margin: 0 !important;
            border-radius: 0 !important;
            transition: all 0.2s ease !important;
            display: flex !important;
            align-items: center !important;
        }

        .navbar-nav .nav-link i {
            margin-right: 0.5rem !important;
            font-size: 0.9rem !important;
        }

        .navbar-nav .nav-link:hover {
            color: #7DD3FC !important;
            background-color: rgba(255, 255, 255, 0.1) !important;
        }

        .navbar-nav .nav-link.active,
        .navbar-nav .nav-link.fw-semibold {
            color: #7DD3FC !important;
            background-color: rgba(255, 255, 255, 0.15) !important;
        }

        /* Dropdown Styling */
        .dropdown-menu {
            background-color: white !important;
            border: none !important;
            border-radius: 8px !important;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1) !important;
            padding: 0.5rem 0 !important;
            margin-top: 0.25rem !important;
        }

        .dropdown-item {
            color: #2E5EAA !important;
            padding: 0.5rem 1rem !important;
            border-radius: 0 !important;
            transition: all 0.2s ease !important;
        }

        .dropdown-item:hover,
        .dropdown-item:focus {
            background-color: #f8f9fa !important;
            color: #2E5EAA !important;
        }

        .dropdown-item i {
            width: 16px !important;
            margin-right: 8px !important;
        }

        .badge {
            font-size: 0.7rem !important;
            font-weight: normal !important;
        }

        /* Navbar toggler for mobile */
        .navbar-toggler {
            border-color: rgba(255, 255, 255, 0.3) !important;
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") !important;
        }

        /* GREEN Promotional Banner */
        .promo-banner {
            background: linear-gradient(90deg, #22C55E 0%, #4ADE80 50%, #22C55E 100%);
            color: white;
            padding: 8px 0;
            font-weight: 600;
            font-size: 0.9rem;
            position: relative;
            overflow: hidden;
        }

        .promo-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .promo-text {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .promo-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .promo-close:hover {
            background: rgba(255,255,255,0.2);
        }

        /* Hero Section Styling */
        .hero-section {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            color: white;
            padding: 2.5rem 0;
            margin-bottom: 0;
            position: relative;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin: 1.5rem 0;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .stat-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 1.5rem 1rem;
            border-radius: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.2s ease;
            cursor: pointer;
            min-width: 120px;
        }

        .stat-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            display: block;
            margin-bottom: 0.25rem;
            background: linear-gradient(135deg, #7DD3FC, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.9;
            font-weight: 500;
        }

        .trust-indicators {
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding-top: 1.5rem;
            margin-top: 1.5rem;
        }

        .shopify-security-badge {
            background: linear-gradient(135deg, #96bf48, #7eb843);
            color: white;
            padding: 0.75rem;
            border-radius: 0.5rem;
            font-weight: 600;
            text-align: center;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 500px;
            margin: 0 auto;
        }

        .patent-badge {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #92400e;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-weight: 700;
            text-align: center;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 600px;
            margin: 1rem auto 0;
            border: 2px solid rgba(146, 64, 14, 0.2);
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3);
        }

        /* FLOATING CART BUTTON */
        .floating-cart {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1000;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 20px;
            box-shadow: 0 8px 25px rgba(46, 94, 170, 0.4);
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            min-width: 60px;
            text-align: center;
        }

        .floating-cart:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 12px 35px rgba(46, 94, 170, 0.6);
            color: white;
        }

        .floating-cart .cart-count {
            background: #dc3545;
            color: white;
            border-radius: 50%;
            font-size: 0.75rem;
            font-weight: 700;
            min-width: 20px;
            height: 20px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-left: 8px;
            position: absolute;
            top: -5px;
            right: -5px;
        }

        .floating-cart .cart-icon {
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .floating-cart {
                display: none;
            }
        }

        /* Cart Preview */
        .cart-preview {
            position: fixed;
            top: 100px;
            right: -420px;
            width: 400px;
            max-height: 80vh;
            background: white;
            border-radius: 1rem 0 0 1rem;
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.15);
            padding: 1.5rem;
            z-index: 1050;
            transition: right 0.3s ease;
            overflow-y: auto;
            border: 2px solid var(--primary-blue);
            border-right: none;
        }

        .cart-preview.show {
            right: 0;
        }

        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1040;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .cart-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        /* Cart Styling */
        .cart-header {
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: 1rem;
        }

        .cart-title {
            color: var(--primary-blue);
            font-weight: 700;
            font-size: 1.1rem;
        }

        .cart-items {
            max-height: 300px;
            overflow-y: auto;
        }

        .empty-cart i {
            opacity: 0.3;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--gray-200);
        }

        .cart-item-info {
            flex-grow: 1;
            margin-right: 1rem;
        }

        .cart-item-name {
            font-weight: 600;
            color: var(--primary-blue);
            font-size: 0.9rem;
        }

        .cart-item-details {
            font-size: 0.75rem;
            color: var(--gray-600);
        }

        .cart-qty-btn {
            background: var(--primary-blue);
            color: white;
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            cursor: pointer;
        }

        .cart-qty-btn:hover {
            background: var(--secondary-blue);
        }

        .cart-item-remove {
            background: #dc3545;
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            font-size: 0.7rem;
            cursor: pointer;
            margin-left: 0.5rem;
        }

        /* Products Section */
        .products-main {
            min-height: 60vh;
            padding: 2rem 0;
        }

        .section-header {
            text-align: center;
            padding: 2.5rem 0 1.5rem;
            margin-bottom: 1.5rem;
        }

        .section-header.organic {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            color: #166534;
            border-radius: 1rem;
        }

        /* Product Cards */
        .product-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.06);
            transition: all 0.2s ease;
            height: 100%;
            overflow: hidden;
            position: relative;
            border: 1px solid var(--gray-200);
            margin-bottom: 1.5rem;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.12);
            border-color: var(--primary-blue);
        }

        /* Coming Soon Styling */
        .product-card.coming-soon {
            opacity: 0.85;
        }

        .product-card.coming-soon::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0.1));
            pointer-events: none;
            border-radius: 1rem;
            z-index: 1;
        }

        .product-card.coming-soon:hover {
            transform: translateY(-2px);
        }

        .coming-soon-badge {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: linear-gradient(135deg, #94a3b8, #64748b);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            z-index: 10;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .product-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.4rem 0.8rem;
            border-radius: 1rem;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            z-index: 5;
        }

        .availability-notice {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            color: #92400e;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
            margin: 1rem 0;
        }

        .btn-notify {
            background: linear-gradient(135deg, #94a3b8, #64748b);
            color: white;
            border: none;
            cursor: not-allowed;
        }

        .btn-notify:hover {
            background: linear-gradient(135deg, #94a3b8, #64748b);
            color: white;
        }

        .price-display {
            background: rgba(46, 94, 170, 0.05);
            padding: 1rem;
            border-radius: 0.75rem;
            margin-bottom: 1rem;
        }

        .current-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-blue);
        }

        .price-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            font-weight: 600;
            color: var(--gray-600);
        }

        /* Product Image Container */
        .product-image-container {
            width: 100%;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 0.5rem;
        }

        .product-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 0.5rem;
        }

        .product-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .product-title {
            color: var(--primary-blue);
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        /* Inventory Badge Styling */
        .inventory-badge {
            position: absolute;
            top: 3.5rem;
            left: 1rem;
            padding: 0.35rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.7rem;
            font-weight: 700;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        /* Out of Stock Styling */
        .product-card.out-of-stock {
            opacity: 0.85;
        }

        .product-card.out-of-stock .product-image-container {
            filter: grayscale(50%);
        }

        .product-card.out-of-stock:hover {
            transform: translateY(-2px);
        }

        .grayscale {
            filter: grayscale(60%);
        }

        /* Low stock pulse animation */
        .bg-warning.inventory-badge {
            animation: lowStockPulse 2s ease-in-out infinite;
        }

        @keyframes lowStockPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Wholesale Progress Indicator */
        .wholesale-indicator {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
            border-radius: 0.5rem;
            padding: 0.75rem;
            font-size: 0.8rem;
        }

        .wholesale-indicator.achieved {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            border-color: #86efac;
        }

        .wholesale-progress-container {
            background: #e2e8f0;
            border-radius: 1rem;
            height: 8px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .wholesale-progress-bar {
            background: linear-gradient(90deg, var(--primary-blue), var(--secondary-blue));
            height: 100%;
            border-radius: 1rem;
            transition: width 0.3s ease;
        }

        .wholesale-indicator.achieved .wholesale-progress-bar {
            background: linear-gradient(90deg, #22c55e, #4ade80);
        }

        .wholesale-message {
            color: var(--primary-blue);
            font-weight: 500;
        }

        .wholesale-indicator.achieved .wholesale-message {
            color: #16a34a;
        }

        .wholesale-savings {
            font-size: 0.7rem;
            margin-top: 0.25rem;
        }

        .wholesale-indicator.achieved .wholesale-savings {
            color: #16a34a !important;
            font-weight: 600;
        }

        /* Footer */
        .footer-section {
            background: #000000;
            color: white;
            padding: 3rem 0 1rem;
            font-size: 0.9rem;
        }

        .footer-brand {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .footer-brand img {
            height: 65px;
            width: auto;
            margin-right: 0.75rem;
        }

        .footer-brand-name {
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
            margin: 0;
        }

        .footer-tagline {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.5;
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }

        .footer-heading {
            color: white;
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 1rem;
            text-transform: uppercase;
        }

        .footer-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-list li {
            margin-bottom: 0.5rem;
        }

        .footer-list a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-size: 0.85rem;
        }

        .footer-list a:hover {
            color: var(--ohs-accent-blue);
        }

        .footer-contact {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.85rem;
        }

        .footer-contact i {
            margin-right: 0.5rem;
            width: 16px;
            color: var(--ohs-accent-blue);
        }

        .footer-contact a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
        }

        .footer-contact a:hover {
            color: var(--ohs-accent-blue);
        }

        .social-icons a {
            color: rgba(255, 255, 255, 0.6);
            font-size: 1.2rem;
            margin-right: 1rem;
            text-decoration: none;
        }

        .social-icons a:hover {
            color: var(--ohs-accent-blue);
        }

        .footer-bottom {
            border-top: 1px solid #333;
            padding-top: 1rem;
            margin-top: 2rem;
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
        }

        .footer-badge {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        @media (max-width: 768px) {
            .hero-stats {
                flex-direction: column;
                gap: 1rem;
                align-items: center;
            }

            .stat-item {
                max-width: 200px;
            }

            .navbar-brand img {
                height: 50px !important;
            }

            .cart-preview {
                width: calc(100vw - 20px);
                right: -100vw;
            }

            .cart-preview.show {
                right: 10px;
            }
        }
    </style>
</head>
<body>

<!-- GREEN Promotional Banner -->
<div class="promo-banner text-center" id="promoBanner">
    <div class="container">
        <div class="d-flex justify-content-center align-items-center">
            <div class="text-center">
                <span class="promo-text">
                    üí∞ <strong>BULK DISCOUNTS AS HIGH AS 42%</strong> available
                </span>
            </div>
            <button class="promo-close ms-3" onclick="closeBanner()" aria-label="Close banner">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>
</div>

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark sticky-top">
    <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="index.html">
            <img src="assets/images/logos/OHS Brand Image.jpg" alt="Organic HypoSolutions Logo">
            <span>Organic HypoSolutions</span>
        </a>
        
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto align-items-center">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">
                        <i class="fas fa-home me-1"></i>Home
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="services.html">
                        <i class="fas fa-spray-can me-1"></i>Services
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link fw-semibold" href="products.html">
                        <i class="fas fa-shopping-bag me-1"></i>Products
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="calculator.html">
                        <i class="fas fa-calculator me-1"></i>Calculator
                    </a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="about.html" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-info-circle me-1"></i>About
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="about.html">
                            <i class="fas fa-info-circle me-2"></i>About Us
                        </a></li>
                        <li><a class="dropdown-item" href="science-certifications.html">
                            <i class="fas fa-microscope me-2"></i>Science & Certifications
                        </a></li>
                        <li><a class="dropdown-item" href="contact.html">
                            <i class="fas fa-phone me-2"></i>Contact
                        </a></li>
                        <li><a class="dropdown-item" href="legal-information.html">
                            <i class="fas fa-gavel me-2"></i>Legal Information
                        </a></li>
                    </ul>
                </li>
                
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-shopping-cart me-1"></i>Shop
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="shop/cart.html">
                            <i class="fas fa-shopping-cart me-2"></i>View Cart 
                            <span id="cartBadge" class="badge bg-danger ms-1" style="display: none;">0</span>
                        </a></li>
                        <li><a class="dropdown-item" href="shop/book-service.html">
                            <i class="fas fa-calendar-plus me-2"></i>Book Service
                        </a></li>
                    </ul>
                </li>
                
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user me-1"></i>Account
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="auth/login.html">
                            <i class="fas fa-sign-in-alt me-2"></i>Login
                            <span class="badge bg-warning ms-1">Coming Soon</span>
                        </a></li>
                        <li><a class="dropdown-item" href="auth/register.html">
                            <i class="fas fa-user-plus me-2"></i>Register
                            <span class="badge bg-warning ms-1">Coming Soon</span>
                        </a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Floating Cart Button -->
<button class="floating-cart" onclick="toggleCart()" id="floatingCartBtn">
    <i class="fas fa-shopping-cart cart-icon"></i>
    <span class="cart-count" id="floatingCartCount" style="display: none;">0</span>
</button>

<!-- Hero Section -->
<section class="hero-section">
    <div class="container text-center">
        <h1 class="display-4 fw-bold mb-3">Professional Hypochlorous Acid Products</h1>
        <p class="lead mb-4">EPA Premium & USDA Organic - Utah Manufactured</p>
        
        <div class="patent-badge">
            <i class="fas fa-certificate me-2"></i>
            <strong>World's Only Organic Hypochlorous Company</strong> ‚Ä¢ Patent Pending Technology
        </div>
        
        <div class="hero-stats mb-4">
            <div class="stat-item">
                <span class="stat-number" id="totalProductCount">6</span>
                <span class="stat-label">Total Products</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="activeProductCount">5</span>
                <span class="stat-label">Available Now</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="comingSoonCount">1</span>
                <span class="stat-label">Coming Soon</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">FAMILY</span>
                <span class="stat-label">Owned</span>
            </div>
        </div>

        <div class="d-flex justify-content-center gap-3 flex-wrap mt-4">
            <button class="btn btn-light btn-lg" onclick="scrollToProducts()">
                <i class="fas fa-boxes me-2"></i>Browse Products
            </button>
            <button class="btn btn-outline-light" onclick="toggleCart()">
                <i class="fas fa-shopping-cart me-2"></i>Cart<span id="heroCartCountWrapper" style="display: none;"> (<span id="heroCartCount">0</span>)</span>
            </button>
            <a href="tel:+18017125663" class="btn btn-outline-light">
                <i class="fas fa-phone me-2"></i>(801) 712-5663
            </a>
        </div>

        <div class="shopify-security-badge mt-4">
            <i class="fas fa-shield-alt me-2"></i>
            <strong>Secure Shopping</strong> - Cart System Active
        </div>

        <div class="trust-indicators mt-3">
            <div class="row">
                <div class="col-6 col-md-3">
                    <small class="text-white-50">
                        <i class="fas fa-certificate me-1"></i>Utah Made
                    </small>
                </div>
                <div class="col-6 col-md-3">
                    <small class="text-white-50">
                        <i class="fas fa-shipping-fast me-1"></i>Fast Shipping
                    </small>
                </div>
                <div class="col-6 col-md-3">
                    <small class="text-white-50">
                        <i class="fas fa-headset me-1"></i>Expert Support
                    </small>
                </div>
                <div class="col-6 col-md-3">
                    <small class="text-white-50">
                        <i class="fas fa-award me-1"></i>Patent Pending
                    </small>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Products Display Section -->
<main class="products-main" id="productsMain">
    <div class="container">
        <div id="productSections">
            <!-- Products will be loaded here by JavaScript -->
        </div>
    </div>
</main>

<!-- Cart Preview -->
<div id="cartPreview" class="cart-preview">
    <div class="cart-header d-flex justify-content-between align-items-center mb-3">
        <h6 class="cart-title mb-0">
            <i class="fas fa-shopping-cart me-2"></i>Shopping Cart
        </h6>
        <button class="btn-close" onclick="toggleCart()"></button>
    </div>
    
    <div id="cartItems" class="cart-items">
        <div class="empty-cart text-center py-4">
            <i class="fas fa-shopping-cart fa-3x mb-3 text-muted"></i>
            <h6 class="text-muted">Your cart is empty</h6>
            <p class="text-muted small">Add products to get started</p>
        </div>
    </div>
    
    <div id="cartSummary" class="cart-summary" style="display: none;">
        <hr class="my-3">
        
        <div class="pricing-breakdown">
            <div class="d-flex justify-content-between mb-2">
                <span>Subtotal:</span>
                <span id="cartSubtotal">$0.00</span>
            </div>
            <div class="d-flex justify-content-between mb-2">
                <span>Shipping:</span>
                <span class="text-info">Calculated at Checkout</span>
            </div>
            <div class="d-flex justify-content-between fw-bold border-top pt-2">
                <span>Total:</span>
                <span id="cartTotal">$0.00</span>
            </div>
        </div>
        
        <div class="cart-actions mt-3">
            <div class="d-grid gap-2">
                <button class="btn btn-primary" onclick="proceedToCart()">
                    <i class="fas fa-shopping-cart me-2"></i>View Cart & Checkout
                </button>
                <div class="row">
                    <div class="col-6">
                        <button class="btn btn-outline-secondary btn-sm w-100" onclick="clearCart()">
                            <i class="fas fa-trash me-1"></i>Clear
                        </button>
                    </div>
                    <div class="col-6">
                        <a href="tel:+18017125663" class="btn btn-outline-success btn-sm w-100">
                            <i class="fas fa-phone me-1"></i>Help
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Cart Overlay -->
<div id="cartOverlay" class="cart-overlay" onclick="toggleCart()"></div>

<!-- Footer -->
<footer class="footer-section">
    <div class="container">
        <div class="row">
            <div class="col-md-3 mb-4">
                <div class="footer-brand">
                    <img src="assets/images/logos/OHS Brand Image.jpg" alt="Organic HypoSolutions Logo">
                    <h5 class="footer-brand-name">Organic HypoSolutions</h5>
                </div>
                <p class="footer-tagline">World's only organic hypochlorous company. Utah's dual-certified HOCl distributor for families and businesses.</p>
                
                <div class="mt-3">
                    <h6 class="footer-heading">Business Hours</h6>
                    <div class="footer-contact">
                        <p class="mb-1">
                            <i class="fas fa-clock"></i>Mon-Fri: 8:00 AM - 6:00 PM
                        </p>
                        <p class="mb-1">
                            <i class="fas fa-clock"></i>Saturday: 9:00 AM - 5:00 PM
                        </p>
                        <p class="mb-1">
                            <i class="fas fa-moon"></i>Sunday: Closed
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-2 mb-4">
                <h6 class="footer-heading">Products</h6>
                <ul class="footer-list">
                    <li><a href="products.html">USDA Organic (6)</a></li>
                    <li><a href="products.html">Coming Soon (1)</a></li>
                    <li><a href="products.html">All Products</a></li>
                </ul>
            </div>
            
            <div class="col-md-2 mb-4">
                <h6 class="footer-heading">Certified</h6>
                <ul class="footer-list">
                    <li><span class="footer-contact">USDA Organic</span></li>
                    <li><span class="footer-contact">EPA Registered</span></li>
                    <li><span class="footer-contact">FDA Food Safe</span></li>
                </ul>
            </div>
            
            <div class="col-md-2 mb-4">
                <h6 class="footer-heading">Support</h6>
                <ul class="footer-list">
                    <li><a href="science-certifications.html">Science</a></li>
                    <li><a href="calculator.html">Calculator</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </div>
            
            <div class="col-md-3 mb-4">
                <h6 class="footer-heading">Contact</h6>
                <div class="footer-contact">
                    <p class="mb-2">
                        <i class="fas fa-phone"></i>
                        <a href="tel:+18017125663">(801) 712-5663</a>
                    </p>
                    <p class="mb-2">
                        <i class="fas fa-envelope"></i>
                        <a href="mailto:OHS@OrganicHypoSolutions.com">OHS@OrganicHypoSolutions.com</a>
                    </p>
                    <p class="mb-3">
                        <i class="fas fa-map-marker-alt"></i>
                        Salt Lake City, UT, USA
                    </p>
                </div>
                
                <div class="social-icons">
                    <a href="https://www.linkedin.com/company/organic-hyposolutions" target="_blank">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="https://www.facebook.com/organichyposolutions" target="_blank">
                        <i class="fab fa-facebook"></i>
                    </a>
                    <a href="https://www.instagram.com/organichyposolutions" target="_blank">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="https://www.tiktok.com/@organic.hyposolutions" target="_blank">
                        <i class="fab fa-tiktok"></i>
                    </a>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="mb-0">&copy; 2025 Organic HypoSolutions. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <span class="footer-badge">6 Products</span>
                    <span class="footer-badge">Family Owned</span>
                    <span class="footer-badge">Patent Pending</span>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

<!-- JavaScript -->
<script>
    // ================================================================
    // SHOPIFY STOREFRONT API CONFIGURATION
    // Credentials loaded from external config file (not committed to repo)
    // ================================================================
    
    let SHOPIFY_CONFIG = {
        domain: null,
        storefrontAccessToken: null,
        apiVersion: '2024-01',
        isConfigured: false
    };
    
    // Load Shopify config from external file
    async function loadShopifyConfig() {
        try {
            const response = await fetch('/scripts/shopify-config.js');
            if (!response.ok) {
                console.warn('‚ö†Ô∏è Shopify config not found. Inventory features disabled.');
                return false;
            }
            
            const configText = await response.text();
            // Execute the config script to get the values
            const configScript = document.createElement('script');
            configScript.textContent = configText;
            document.head.appendChild(configScript);
            
            // Check if config was loaded
            if (window.SHOPIFY_CREDENTIALS) {
                SHOPIFY_CONFIG.domain = window.SHOPIFY_CREDENTIALS.domain;
                SHOPIFY_CONFIG.storefrontAccessToken = window.SHOPIFY_CREDENTIALS.storefrontAccessToken;
                SHOPIFY_CONFIG.isConfigured = true;
                console.log('‚úÖ Shopify config loaded successfully');
                return true;
            }
            
            return false;
        } catch (error) {
            console.warn('‚ö†Ô∏è Could not load Shopify config:', error.message);
            return false;
        }
    }
    
    // ================================================================
    // UNIFIED CART SYSTEM
    // ================================================================
    
    const CART_STORAGE_KEY = 'ohsCart';
    let cartItems = JSON.parse(localStorage.getItem(CART_STORAGE_KEY) || '[]');
    
    // Inventory cache
    let inventoryCache = {};
    let lastInventoryFetch = null;
    const INVENTORY_CACHE_DURATION = 60000; // 1 minute cache
    
    // ================================================================
    // PRODUCT CATALOG WITH UPDATED PRICING (JANUARY 2025)
    // Subscription prices are stored but NOT displayed or used
    // ================================================================
    
    const ENABLE_COMING_SOON_PRODUCTS = {
        'ohs-32oz-laundry-booster': false,
        'ohs-organic-wipes': false,
        'ohs-1gal-laundry-booster': false,
        'ohs-healing-serum': false
    };

    const PRODUCT_CATALOG = {
        // ============================================================
        // PRODUCT 1: 32oz Organic Ready-to-Use Cleaner
        // Shopify Product ID: 7249401053255
        // ============================================================
        'ohs-32oz-organic-cleaner': {
            id: 'ohs-32oz-organic-cleaner',
            shopifyProductId: '7249401053255',
            shopifyHandle: '32oz-organic-ready-to-use-cleaner',
            name: '32oz Organic Ready-to-Use Cleaner - USDA Certified',
            description: 'Professional-strength ready-to-use hypochlorous acid cleaner and disinfectant. USDA Certified Organic (#Z-699995-2008) and EPA registered (#97801-1). Kills 99.9% of pathogens including bacteria viruses and fungi. Safe for food contact surfaces toys and skin. Perfect for homes offices restaurants and healthcare facilities. No harsh chemicals no toxic fumes. Simply spray and wipe. Made in Utah USA.',
            sku: 'OHS-32OZ-RTU-RETAIL',
            weight: 2.2,
            category: 'Commercial Cleaning',
            certifications: ['USDA Organic', 'EPA Registered', 'Food Safe'],
            productLine: 'organic',
            useCase: ['residential', 'commercial', 'professional'],
            badgeType: 'USDA Organic',
            badgeColor: '#4ADE80',
            pricing: {
                retail: 19.99,
                wholesale: 13.99
                // Subscription prices hidden: retailSub: 17.99, wholesaleSub: 12.59
            },
            wholesaleThreshold: 25,
            type: 'organic',
            emoji: 'üßΩ',
            image: 'assets/images/products/32oz_organic_ready_to_use_cleaner.jpeg',
            shopifyVariants: {
                retail: '41829068537927',
                wholesale: '41829068603463'
                // Subscription variants hidden: retailSub: '41829068570695', wholesaleSub: '41829068636231'
            },
            status: 'active'
        },
        
        // ============================================================
        // PRODUCT 2: 1 Gallon Organic Ready-to-Use Solution
        // Shopify Product ID: 7249401086023
        // ============================================================
        'ohs-1gal-organic-solution': {
            id: 'ohs-1gal-organic-solution',
            shopifyProductId: '7249401086023',
            shopifyHandle: '1-gallon-organic-ready-to-use-solution',
            name: '1 Gallon Organic Ready-to-Use Solution - USDA Certified',
            description: 'Bulk premium professional-grade hypochlorous acid cleaner and disinfectant for large-scale applications. Advanced formulation with premium packaging. Kills 99.9% of pathogens including bacteria viruses and fungi. Perfect for premium commercial facilities luxury establishments and high-end bulk users. Safe for food contact surfaces and skin. Cost-effective solution for high-volume premium cleaning needs. Made in Utah USA.',
            sku: 'OHS-1GAL-READY-RTU-RETAIL',
            weight: 8.5,
            category: 'Commercial Cleaning',
            certifications: ['USDA Organic', 'EPA Registered', 'Food Safe'],
            productLine: 'organic',
            useCase: ['commercial', 'bulk', 'food-safe'],
            badgeType: 'USDA Organic',
            badgeColor: '#4ADE80',
            pricing: {
                retail: 32.99,
                wholesale: 20.99
                // Subscription prices hidden: retailSub: 29.69, wholesaleSub: 18.89
            },
            wholesaleThreshold: 10,
            type: 'organic',
            emoji: 'üåø',
            image: 'assets/images/products/1_gallon_organic_ready_to_use_solution.jpg',
            shopifyVariants: {
                retail: '41829068701767',
                wholesale: '41829068767303'
                // Subscription variants hidden: retailSub: '41829068734535', wholesaleSub: '41829068800071'
            },
            status: 'active'
        },
        
        // ============================================================
        // PRODUCT 3: All in One Hypochlorous Organic Wipes
        // Shopify Product ID: 7249401315399
        // Status: Coming Soon
        // ============================================================
        'ohs-organic-wipes': {
            id: 'ohs-organic-wipes',
            shopifyProductId: '7249401315399',
            shopifyHandle: 'ohs-organic-wipes',
            name: 'All in One Hypochlorous Organic Wipes',
            description: 'Convenient pre-moistened hypochlorous acid wipes. USDA Certified Organic and EPA registered. Kills 99.9% of pathogens. Perfect for quick cleaning and disinfecting on-the-go. Safe for all surfaces including food contact. Ideal for homes offices travel and healthcare. Non-toxic alcohol-free formula. Made in Utah USA.',
            sku: 'OHS-ALL-IN-ONE-WIPES',
            weight: 1.5,
            category: 'Cleaning Supplies',
            certifications: ['USDA Organic', 'EPA Registered', 'Eco-Friendly'],
            productLine: 'organic',
            useCase: ['convenient', 'disinfecting', 'wipes'],
            badgeType: 'USDA Organic',
            badgeColor: '#4ADE80',
            pricing: {
                retail: 12.99,
                wholesale: 10.99
                // Subscription prices hidden: retailSub: 11.69, wholesaleSub: 9.99
            },
            wholesaleThreshold: 20,
            type: 'organic',
            emoji: 'üßª',
            image: 'assets/images/products/organic_all_in_one_disinfecting_wipes.jpg',
            shopifyVariants: {
                retail: '41829069619271',
                wholesale: '41829069684807'
                // Subscription variants hidden: retailSub: '41829069652039', wholesaleSub: '41829069717575'
            },
            status: 'active'
        },
        
        // ============================================================
        // PRODUCT 4: 32oz Organic Laundry Booster W/ Cap
        // Shopify Product ID: 7249400004679
        // Status: Coming Soon
        // ============================================================
        'ohs-32oz-laundry-booster': {
            id: 'ohs-32oz-laundry-booster',
            shopifyProductId: '7249400004679',
            shopifyHandle: 'ohs-32oz-organic-laundry-booster',
            name: '32oz Organic Laundry Booster W/ Cap - USDA Certified',
            description: 'Premium laundry enhancement solution using hypochlorous acid technology. USDA Certified Organic. Eliminates odors brightens whites and provides antimicrobial protection to fabrics. Safe for all fabric types and colors. Perfect for households and commercial laundries. Non-toxic non-irritating formula. Eco-friendly alternative to harsh chemicals. Made in Utah USA.',
            sku: 'HC-32OZ-LAUNDRY-BOOSTER-RETAIL',
            weight: 2.2,
            category: 'Laundry Care',
            certifications: ['USDA Organic', 'EPA Registered', 'Eco-Friendly'],
            productLine: 'organic',
            useCase: ['laundry', 'odor-elimination', 'eco-friendly'],
            badgeType: 'USDA Organic',
            badgeColor: '#4ADE80',
            pricing: {
                retail: 15.99,
                wholesale: 10.99
                // Subscription prices hidden: retailSub: 14.39, wholesaleSub: 9.89
            },
            wholesaleThreshold: 25,
            type: 'organic',
            emoji: 'üß∫',
            image: 'assets/images/products/32oz_organic_laundry.jpeg',
            shopifyVariants: {
                retail: '41829064572999',
                wholesale: '41829064638535'
                // Subscription variants hidden: retailSub: '41829064605767', wholesaleSub: '41829064671303'
            },
            status: 'active'
        },
        
        // ============================================================
        // PRODUCT 5: 1 Gallon Organic Laundry Booster W/ Cap
        // Shopify Product ID: 7249400037447
        // Status: Coming Soon
        // ============================================================
        'ohs-1gal-laundry-booster': {
            id: 'ohs-1gal-laundry-booster',
            shopifyProductId: '7249400037447',
            shopifyHandle: 'ohs-1-gallon-organic-laundry-booster',
            name: '1 Gallon Organic Laundry Booster W/ Cap - USDA Certified',
            description: 'Bulk premium laundry enhancement solution using hypochlorous acid technology. USDA Certified Organic. Eliminates odors brightens whites and provides antimicrobial protection to fabrics. Perfect for commercial laundries hotels and professional cleaning services. Safe for all fabric types and colors. Cost-effective bulk solution for high-volume laundry needs. Eco-friendly alternative to harsh chemicals. Made in Utah USA.',
            sku: 'HC-1GAL-LAUNDRY-BOOSTER-RETAIL',
            weight: 8.5,
            category: 'Laundry Care',
            certifications: ['USDA Organic', 'EPA Registered', 'Eco-Friendly'],
            productLine: 'organic',
            useCase: ['bulk', 'commercial', 'laundry'],
            badgeType: 'USDA Organic',
            badgeColor: '#4ADE80',
            pricing: {
                retail: 28.99,
                wholesale: 19.99
                // Subscription prices hidden: retailSub: 26.09, wholesaleSub: 17.99
            },
            wholesaleThreshold: 10,
            type: 'organic',
            emoji: 'üß∫',
            image: 'assets/images/products/1gallon_organic_laundry_booster.jpg',
            shopifyVariants: {
                retail: '41829064704071',
                wholesale: '41829064769607'
                // Subscription variants hidden: retailSub: '41829064736839', wholesaleSub: '41829064802375'
            },
            status: 'active'
        },
        
        // ============================================================
        // PRODUCT 6: OHS Pure Healing Skin Serum (NEW)
        // Shopify Product ID: 7249401348167
        // Status: Coming Soon - Pricing TBD
        // ============================================================
        'ohs-healing-serum': {
            id: 'ohs-healing-serum',
            shopifyProductId: '7249401348167',
            shopifyHandle: 'ohs-pure-healing-skin-serum',
            name: 'OHS Pure Healing Skin Serum',
            description: 'Premium hypochlorous acid skin serum for healing and rejuvenation. Gentle yet effective formula supports natural skin healing processes. Perfect for sensitive skin, post-procedure care, and daily skincare routines. Non-irritating, dermatologist-recommended formula. Made in Utah USA.',
            sku: 'OHS-HEALING-SERUM-RETAIL',
            weight: 0.5,
            category: 'Skincare',
            certifications: ['USDA Organic', 'Dermatologist Tested'],
            productLine: 'organic',
            useCase: ['skincare', 'healing', 'sensitive-skin'],
            badgeType: 'USDA Organic',
            badgeColor: '#4ADE80',
            pricing: {
                retail: null, // TBD
                wholesale: null // TBD
            },
            wholesaleThreshold: null,
            type: 'organic',
            emoji: '‚ú®',
            image: 'assets/images/products/OHS_Skin_Serum.jpeg',
            shopifyVariants: {
                retail: '41829069750343',
                wholesale: '41829069815879'
            },
            status: 'coming-soon',
            availabilityText: 'Coming Soon - Pricing TBD'
        }
    };

    let cartVisible = false;
    let productQuantities = {};

    // ================================================================
    // SHOPIFY STOREFRONT API - INVENTORY FETCHING
    // ================================================================
    
    async function fetchShopifyInventory() {
        // Check if Shopify is configured
        if (!SHOPIFY_CONFIG.isConfigured) {
            console.log('‚ö†Ô∏è Shopify not configured - skipping inventory fetch');
            return {};
        }
        
        // Check cache first
        if (lastInventoryFetch && (Date.now() - lastInventoryFetch) < INVENTORY_CACHE_DURATION) {
            console.log('üì¶ Using cached inventory data');
            return inventoryCache;
        }
        
        const productIds = Object.values(PRODUCT_CATALOG)
            .filter(p => p.shopifyProductId && p.status === 'active')
            .map(p => `gid://shopify/Product/${p.shopifyProductId}`);
        
        if (productIds.length === 0) {
            console.log('‚ö†Ô∏è No active products with Shopify IDs');
            return {};
        }
        
        const query = `
            query getProductsInventory($ids: [ID!]!) {
                nodes(ids: $ids) {
                    ... on Product {
                        id
                        title
                        availableForSale
                        totalInventory
                        variants(first: 10) {
                            edges {
                                node {
                                    id
                                    title
                                    availableForSale
                                    quantityAvailable
                                    sku
                                }
                            }
                        }
                    }
                }
            }
        `;
        
        try {
            console.log('üîÑ Fetching inventory from Shopify...');
            
            const response = await fetch(`https://${SHOPIFY_CONFIG.domain}/api/${SHOPIFY_CONFIG.apiVersion}/graphql.json`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Shopify-Storefront-Access-Token': SHOPIFY_CONFIG.storefrontAccessToken
                },
                body: JSON.stringify({
                    query: query,
                    variables: { ids: productIds }
                })
            });
            
            if (!response.ok) {
                throw new Error(`Shopify API error: ${response.status}`);
            }
            
            const data = await response.json();
            
            if (data.errors) {
                console.error('Shopify GraphQL errors:', data.errors);
                throw new Error('GraphQL query failed');
            }
            
            // Process and cache inventory data
            inventoryCache = {};
            
            data.data.nodes.forEach(product => {
                if (!product) return;
                
                const shopifyProductId = product.id.replace('gid://shopify/Product/', '');
                
                // Find matching local product
                const localProduct = Object.values(PRODUCT_CATALOG).find(
                    p => p.shopifyProductId === shopifyProductId
                );
                
                if (localProduct) {
                    // Get total inventory and variant-specific data
                    const variantData = {};
                    product.variants.edges.forEach(({ node: variant }) => {
                        const variantId = variant.id.replace('gid://shopify/ProductVariant/', '');
                        variantData[variantId] = {
                            available: variant.availableForSale,
                            quantity: variant.quantityAvailable,
                            sku: variant.sku
                        };
                    });
                    
                    inventoryCache[localProduct.id] = {
                        totalInventory: product.totalInventory,
                        availableForSale: product.availableForSale,
                        variants: variantData
                    };
                }
            });
            
            lastInventoryFetch = Date.now();
            console.log('‚úÖ Inventory fetched successfully:', inventoryCache);
            
            return inventoryCache;
            
        } catch (error) {
            console.error('‚ùå Failed to fetch Shopify inventory:', error);
            // Return empty cache on error - products will show without inventory info
            return {};
        }
    }
    
    function getInventoryStatus(productId) {
        const inventory = inventoryCache[productId];
        
        if (!inventory) {
            return {
                status: 'unknown',
                message: '',
                quantity: null,
                canPurchase: true,
                badgeClass: '',
                badgeText: ''
            };
        }
        
        const qty = inventory.totalInventory;
        
        if (!inventory.availableForSale || qty <= 0) {
            return {
                status: 'out-of-stock',
                message: 'Out of Stock',
                quantity: 0,
                canPurchase: false,
                badgeClass: 'bg-danger',
                badgeText: 'Out of Stock'
            };
        } else if (qty <= 5) {
            return {
                status: 'low-stock',
                message: `Only ${qty} left!`,
                quantity: qty,
                canPurchase: true,
                badgeClass: 'bg-warning text-dark',
                badgeText: `Only ${qty} left!`
            };
        } else if (qty <= 20) {
            return {
                status: 'limited',
                message: `${qty} in stock`,
                quantity: qty,
                canPurchase: true,
                badgeClass: 'bg-info',
                badgeText: `${qty} in stock`
            };
        } else {
            return {
                status: 'in-stock',
                message: 'In Stock',
                quantity: qty,
                canPurchase: true,
                badgeClass: 'bg-success',
                badgeText: 'In Stock'
            };
        }
    }
    
    function getVariantInventory(productId, variantId) {
        const inventory = inventoryCache[productId];
        if (!inventory || !inventory.variants[variantId]) {
            return { available: true, quantity: null };
        }
        return inventory.variants[variantId];
    }

    // ================================================================
    // PRICING FUNCTIONS - WHOLESALE THRESHOLD LOGIC
    // (Subscription pricing removed from display)
    // ================================================================

    function getPricingTier(product, quantity) {
        // Skip pricing for products with TBD pricing
        if (product.pricing.retail === null) {
            return {
                isWholesale: false,
                price: 0,
                variantId: product.shopifyVariants.retail,
                tier: 'TBD',
                savingsPerUnit: 0
            };
        }
        
        const threshold = product.wholesaleThreshold || 999999;
        const isWholesale = quantity >= threshold;
        
        return {
            isWholesale: isWholesale,
            price: isWholesale ? product.pricing.wholesale : product.pricing.retail,
            variantId: isWholesale ? product.shopifyVariants.wholesale : product.shopifyVariants.retail,
            tier: isWholesale ? 'Wholesale' : 'Retail',
            savingsPerUnit: isWholesale ? (product.pricing.retail - product.pricing.wholesale) : 0
        };
    }

    function displayPricingInfo(productId, quantity) {
        const product = PRODUCT_CATALOG[productId];
        if (!product || product.pricing.retail === null) return;
        
        const qty = parseInt(quantity) || 1;
        const pricingInfo = getPricingTier(product, qty);
        const priceDisplay = document.querySelector(`[data-product-id="${productId}"] .price-display`);
        
        if (priceDisplay && pricingInfo.isWholesale) {
            priceDisplay.innerHTML = `
                <div class="current-price text-success">$${pricingInfo.price.toFixed(2)}</div>
                <div class="price-label text-success">Wholesale Price</div>
                <small class="text-success">Saving $${pricingInfo.savingsPerUnit.toFixed(2)}/unit!</small>
            `;
        } else if (priceDisplay) {
            priceDisplay.innerHTML = `
                <div class="current-price">$${product.pricing.retail.toFixed(2)}</div>
                <div class="price-label">Retail Price</div>
                ${product.wholesaleThreshold ? `<small class="text-info">Wholesale at ${product.wholesaleThreshold}+ units</small>` : ''}
            `;
        }
        
        // Update wholesale indicator
        updateWholesaleIndicator(productId, qty);
    }
    
    function updateWholesaleIndicator(productId, quantity) {
        const product = PRODUCT_CATALOG[productId];
        if (!product || !product.wholesaleThreshold) return;
        
        const indicator = document.getElementById(`wholesale-indicator-${productId}`);
        const progressBar = document.getElementById(`wholesale-progress-${productId}`);
        const message = document.getElementById(`wholesale-message-${productId}`);
        const savings = document.getElementById(`wholesale-savings-${productId}`);
        
        if (!indicator || !progressBar || !message || !savings) return;
        
        const threshold = product.wholesaleThreshold;
        const qty = parseInt(quantity) || 1;
        const remaining = threshold - qty;
        const progress = Math.min((qty / threshold) * 100, 100);
        const savingsPerUnit = product.pricing.retail - product.pricing.wholesale;
        const totalSavings = savingsPerUnit * qty;
        
        // Update progress bar
        progressBar.style.width = `${progress}%`;
        
        if (qty >= threshold) {
            // Wholesale achieved!
            indicator.classList.add('achieved');
            message.innerHTML = `<i class="fas fa-check-circle me-1"></i><strong>Wholesale Pricing Unlocked!</strong>`;
            savings.innerHTML = `You're saving <strong>$${totalSavings.toFixed(2)}</strong> total ($${savingsPerUnit.toFixed(2)}/unit)`;
        } else {
            // Not yet at wholesale
            indicator.classList.remove('achieved');
            message.innerHTML = `<i class="fas fa-tag me-1"></i>Add <strong>${remaining}</strong> more for wholesale pricing!`;
            savings.innerHTML = `Save <strong>$${savingsPerUnit.toFixed(2)}</strong>/unit at wholesale (${threshold}+ qty)`;
        }
    }

    // ================================================================
    // PRODUCT DISPLAY WITH INVENTORY
    // ================================================================

    async function loadProducts() {
        const container = document.getElementById('productSections');
        
        // Show loading state
        container.innerHTML = `
            <div class="text-center py-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-3 text-muted">Loading products & inventory...</p>
            </div>
        `;
        
        // Fetch inventory from Shopify
        await fetchShopifyInventory();
        
        const products = Object.values(PRODUCT_CATALOG);
        
        let html = `
            <section class="mb-4">
                <div class="section-header organic">
                    <h2><i class="fas fa-leaf me-2"></i>USDA Organic Line</h2>
                    <p>Family-safe USDA Certified Organic Products</p>
                </div>
                <div class="row">
        `;
        
        products.forEach(product => {
            const isComingSoon = product.status === 'coming-soon' && !ENABLE_COMING_SOON_PRODUCTS[product.id];
            const retail = product.pricing?.retail || 0;
            const hasPricing = product.pricing.retail !== null;
            productQuantities[product.id] = 1;
            
            // Get inventory status
            const inventoryStatus = getInventoryStatus(product.id);
            const isOutOfStock = inventoryStatus.status === 'out-of-stock';
            
            html += `
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="product-card ${isComingSoon ? 'coming-soon' : ''} ${isOutOfStock ? 'out-of-stock' : ''}" data-product-id="${product.id}">
                        ${isComingSoon ? `
                            <div class="coming-soon-badge">
                                <i class="fas fa-clock me-1"></i>COMING SOON
                            </div>
                        ` : ''}
                        
                        ${!isComingSoon && inventoryStatus.badgeText ? `
                            <div class="inventory-badge ${inventoryStatus.badgeClass}">
                                <i class="fas fa-${inventoryStatus.status === 'out-of-stock' ? 'times-circle' : inventoryStatus.status === 'low-stock' ? 'exclamation-triangle' : 'check-circle'} me-1"></i>${inventoryStatus.badgeText}
                            </div>
                        ` : ''}
                        
                        <div class="product-badge" style="background: ${product.badgeColor}; color: white;">
                            <i class="fas fa-leaf me-1"></i>${product.badgeType}
                        </div>
                        
                        <div class="card-body p-3 text-center" style="position: relative; z-index: 2;">
                            <div class="product-image-container ${isOutOfStock ? 'grayscale' : ''}">
                                <img src="${product.image}" alt="${product.name}" class="product-image" 
                                     onerror="this.onerror=null; this.src='https://placehold.co/200x200/2E5EAA/white?text=${encodeURIComponent(product.name.split(' ')[0])}';">
                            </div>
                            <h5 class="product-title">${product.name}</h5>
                            <p class="text-muted small mb-2">${product.description}</p>
                            
                            ${isComingSoon ? `
                                <div class="availability-notice">
                                    <i class="fas fa-hourglass-half me-2"></i>
                                    <strong>${product.availabilityText}</strong>
                                </div>
                                <div class="text-muted small mb-3">SKU: ${product.sku}</div>
                                <button class="btn btn-notify w-100 mb-2" disabled>
                                    <i class="fas fa-bell me-2"></i>Coming Soon - Notify Me
                                </button>
                                <small class="text-muted d-block">
                                    <i class="fas fa-info-circle me-1"></i>This product will be available soon
                                </small>
                            ` : isOutOfStock ? `
                                <div class="price-display mb-3" style="opacity: 0.6;">
                                    <div class="current-price">$${retail.toFixed(2)}</div>
                                    <div class="price-label">Retail Price</div>
                                </div>
                                <div class="text-muted small mb-2">SKU: ${product.sku}</div>
                                <div class="alert alert-danger py-2 px-3 mb-2">
                                    <i class="fas fa-times-circle me-1"></i>
                                    <strong>Currently Out of Stock</strong>
                                </div>
                                <button class="btn btn-secondary w-100 mb-2" disabled>
                                    <i class="fas fa-times me-2"></i>Out of Stock
                                </button>
                                <a href="mailto:OHS@OrganicHypoSolutions.com?subject=Stock%20Notification%20-%20${encodeURIComponent(product.name)}" class="btn btn-sm btn-outline-primary w-100">
                                    <i class="fas fa-envelope me-1"></i>Notify When Available
                                </a>
                            ` : `
                                <div class="price-display mb-3">
                                    <div class="current-price">$${retail.toFixed(2)}</div>
                                    <div class="price-label">Retail Price</div>
                                    ${product.wholesaleThreshold ? `<small class="text-info">Wholesale at ${product.wholesaleThreshold}+ units</small>` : ''}
                                </div>
                                <div class="text-muted small mb-2">SKU: ${product.sku}</div>
                                
                                <!-- Wholesale Progress Indicator -->
                                ${product.wholesaleThreshold ? `
                                <div id="wholesale-indicator-${product.id}" class="wholesale-indicator mb-2">
                                    <div class="wholesale-progress-container">
                                        <div class="wholesale-progress-bar" id="wholesale-progress-${product.id}" style="width: 0%"></div>
                                    </div>
                                    <div class="wholesale-message" id="wholesale-message-${product.id}">
                                        <i class="fas fa-tag me-1"></i>Add <strong>${product.wholesaleThreshold - 1}</strong> more for wholesale pricing!
                                    </div>
                                    <div class="wholesale-savings text-muted" id="wholesale-savings-${product.id}">
                                        Save <strong>$${(retail - product.pricing.wholesale).toFixed(2)}</strong>/unit at wholesale
                                    </div>
                                </div>
                                ` : ''}
                                
                                ${inventoryStatus.status === 'low-stock' ? `
                                    <div class="alert alert-warning py-2 px-3 mb-2" style="font-size: 0.8rem;">
                                        <i class="fas fa-exclamation-triangle me-1"></i>
                                        <strong>Low Stock!</strong> Only ${inventoryStatus.quantity} remaining
                                    </div>
                                ` : ''}
                                <ul class="list-unstyled small mb-3">
                                    <li><i class="fas fa-check text-success me-1"></i>Family & Pet Safe</li>
                                    <li><i class="fas fa-check text-success me-1"></i>Utah Made</li>
                                    <li><i class="fas fa-check text-success me-1"></i>USDA Certified</li>
                                </ul>
                                <div class="input-group mb-2">
                                    <button class="btn btn-outline-primary btn-sm" onclick="changeQuantity('${product.id}', -1)">
                                        <i class="fas fa-minus"></i>
                                    </button>
                                    <input type="number" class="form-control form-control-sm text-center" 
                                           id="qty-${product.id}" value="1" min="1" max="${inventoryStatus.quantity || 999}" style="max-width: 70px;"
                                           onchange="validateQuantity('${product.id}', this.value); displayPricingInfo('${product.id}', this.value)"
                                           oninput="updateWholesaleIndicator('${product.id}', this.value)">
                                    <button class="btn btn-outline-primary btn-sm" onclick="changeQuantity('${product.id}', 1)">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                                <button class="btn btn-success w-100 mb-2" onclick="addToCart('${product.id}')">
                                    <i class="fas fa-cart-plus me-2"></i>Add to Cart
                                </button>
                                <a href="tel:+18017125663" class="btn btn-sm btn-outline-info">
                                    <i class="fas fa-phone me-1"></i>Questions?
                                </a>
                            `}
                        </div>
                    </div>
                </div>
            `;
        });
        
        html += '</div></section>';
        container.innerHTML = html;
        
        // Update inventory status display periodically
        setInterval(refreshInventoryDisplay, INVENTORY_CACHE_DURATION);
    }
    
    async function refreshInventoryDisplay() {
        await fetchShopifyInventory();
        
        // Update inventory badges and stock status
        Object.keys(PRODUCT_CATALOG).forEach(productId => {
            const product = PRODUCT_CATALOG[productId];
            if (product.status !== 'active') return;
            
            const inventoryStatus = getInventoryStatus(productId);
            const card = document.querySelector(`[data-product-id="${productId}"]`);
            
            if (card) {
                const inventoryBadge = card.querySelector('.inventory-badge');
                if (inventoryBadge) {
                    inventoryBadge.className = `inventory-badge ${inventoryStatus.badgeClass}`;
                    inventoryBadge.innerHTML = `<i class="fas fa-${inventoryStatus.status === 'out-of-stock' ? 'times-circle' : inventoryStatus.status === 'low-stock' ? 'exclamation-triangle' : 'check-circle'} me-1"></i>${inventoryStatus.badgeText}`;
                }
                
                // Update max quantity on input
                const qtyInput = document.getElementById(`qty-${productId}`);
                if (qtyInput && inventoryStatus.quantity) {
                    qtyInput.max = inventoryStatus.quantity;
                }
            }
        });
        
        console.log('üîÑ Inventory display refreshed');
    }
    
    function validateQuantity(productId, value) {
        const inventoryStatus = getInventoryStatus(productId);
        const input = document.getElementById(`qty-${productId}`);
        
        if (!input) return;
        
        let qty = parseInt(value) || 1;
        
        // Ensure minimum of 1
        if (qty < 1) qty = 1;
        
        // Check against inventory if available
        if (inventoryStatus.quantity !== null && qty > inventoryStatus.quantity) {
            qty = inventoryStatus.quantity;
            showNotification(`Only ${inventoryStatus.quantity} available in stock`, 'warning');
        }
        
        input.value = qty;
        productQuantities[productId] = qty;
    }

    function changeQuantity(productId, change) {
        const input = document.getElementById(`qty-${productId}`);
        if (!input) return;
        
        const inventoryStatus = getInventoryStatus(productId);
        const maxQty = inventoryStatus.quantity || 999;
        
        let newValue = Math.max(1, parseInt(input.value) + change);
        
        // Check against inventory
        if (newValue > maxQty) {
            newValue = maxQty;
            showNotification(`Only ${maxQty} available in stock`, 'warning');
        }
        
        input.value = newValue;
        productQuantities[productId] = newValue;
        displayPricingInfo(productId, newValue);
    }

    async function addToCart(productId) {
        const product = PRODUCT_CATALOG[productId];
        if (!product) {
            console.error(`Product ${productId} not found`);
            return;
        }
        
        // Don't allow adding products with TBD pricing
        if (product.pricing.retail === null) {
            showNotification('This product is not yet available for purchase.', 'error');
            return;
        }
        
        // Check inventory before adding
        const inventoryStatus = getInventoryStatus(productId);
        if (!inventoryStatus.canPurchase) {
            showNotification('Sorry, this product is currently out of stock.', 'error');
            return;
        }
        
        const quantity = productQuantities[productId] || 1;
        
        // Validate against available inventory
        if (inventoryStatus.quantity !== null && quantity > inventoryStatus.quantity) {
            showNotification(`Only ${inventoryStatus.quantity} available. Adjusted quantity.`, 'warning');
            productQuantities[productId] = inventoryStatus.quantity;
            const input = document.getElementById(`qty-${productId}`);
            if (input) input.value = inventoryStatus.quantity;
            return;
        }
        
        // Check if adding to existing cart item would exceed inventory
        const existingItem = cartItems.find(item => item.productId === productId);
        if (existingItem && inventoryStatus.quantity !== null) {
            const totalQty = existingItem.quantity + quantity;
            if (totalQty > inventoryStatus.quantity) {
                const canAdd = inventoryStatus.quantity - existingItem.quantity;
                if (canAdd <= 0) {
                    showNotification(`You already have the maximum available quantity (${inventoryStatus.quantity}) in your cart.`, 'warning');
                    return;
                }
                showNotification(`Only ${canAdd} more can be added. You have ${existingItem.quantity} in cart.`, 'warning');
                return;
            }
        }
        
        const pricingInfo = getPricingTier(product, quantity);
        
        try {
            const existingItemIndex = cartItems.findIndex(item => item.productId === productId);
            
            if (existingItemIndex !== -1) {
                const newQuantity = cartItems[existingItemIndex].quantity + quantity;
                const updatedPricing = getPricingTier(product, newQuantity);
                
                cartItems[existingItemIndex].quantity = newQuantity;
                cartItems[existingItemIndex].price = updatedPricing.price;
                cartItems[existingItemIndex].variantId = updatedPricing.variantId;
                cartItems[existingItemIndex].pricingTier = updatedPricing.tier;
                cartItems[existingItemIndex].isWholesale = updatedPricing.isWholesale;
            } else {
                cartItems.push({
                    productId: productId,
                    shopifyProductId: product.shopifyProductId,
                    name: product.name,
                    price: pricingInfo.price,
                    category: product.badgeType,
                    quantity: quantity,
                    variantId: pricingInfo.variantId,
                    handle: product.shopifyHandle,
                    sku: product.sku,
                    type: product.type,
                    emoji: product.emoji,
                    pricingTier: pricingInfo.tier,
                    isWholesale: pricingInfo.isWholesale,
                    wholesaleThreshold: product.wholesaleThreshold,
                    addedAt: new Date().toISOString()
                });
            }
            
            localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cartItems));
            window.dispatchEvent(new Event('storage'));
            
            updateCartBadges();
            updateCartPreview();
            
            const tierInfo = pricingInfo.isWholesale ? ` at Wholesale Price ($${pricingInfo.savingsPerUnit.toFixed(2)}/unit savings!)` : '';
            showNotification(`Added ${quantity}x ${product.name}${tierInfo} to cart!`, 'success');
            
            console.log(`‚úÖ Added ${quantity}x ${product.name} at ${pricingInfo.tier} price`);
            
            const input = document.getElementById(`qty-${productId}`);
            if (input) input.value = 1;
            productQuantities[productId] = 1;
            displayPricingInfo(productId, 1);
            
            if (typeof gtag !== 'undefined') {
                gtag('event', 'add_to_cart', {
                    'currency': 'USD',
                    'value': pricingInfo.price * quantity,
                    'items': [{
                        'item_id': pricingInfo.variantId,
                        'item_name': product.name,
                        'category': product.badgeType,
                        'quantity': quantity,
                        'price': pricingInfo.price,
                        'item_variant': pricingInfo.tier
                    }]
                });
            }
            
        } catch (error) {
            console.error('Error adding product to cart:', error);
            showNotification('Failed to add product. Please try again.', 'error');
        }
    }

    // ================================================================
    // CART FUNCTIONS - WITH WHOLESALE PRICING
    // ================================================================

    function updateCartPreview() {
        const cartItemsContainer = document.getElementById('cartItems');
        const cartSummary = document.getElementById('cartSummary');
        
        cartItems = JSON.parse(localStorage.getItem(CART_STORAGE_KEY) || '[]');
        
        if (!Array.isArray(cartItems) || cartItems.length === 0) {
            cartItemsContainer.innerHTML = `
                <div class="empty-cart text-center py-4">
                    <i class="fas fa-shopping-cart fa-3x mb-3 text-muted"></i>
                    <h6 class="text-muted">Your cart is empty</h6>
                    <p class="text-muted small">Add products to get started</p>
                </div>
            `;
            if (cartSummary) cartSummary.style.display = 'none';
            return;
        }
        
        let itemsHTML = '';
        let subtotal = 0;
        
        cartItems.forEach(item => {
            const itemTotal = item.price * item.quantity;
            subtotal += itemTotal;
            
            const tierBadge = item.isWholesale 
                ? '<span class="badge bg-success ms-1" style="font-size: 0.65rem;">Wholesale</span>' 
                : '';
            
            itemsHTML += `
                <div class="cart-item">
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.emoji || 'üì¶'} ${item.name}${tierBadge}</div>
                        <div class="cart-item-details">
                            SKU: ${item.sku || 'N/A'} ‚Ä¢ $${item.price.toFixed(2)} each
                        </div>
                    </div>
                    <div class="d-flex align-items-center">
                        <button class="cart-qty-btn" onclick="updateCartQuantity('${item.productId}', -1)">
                            <i class="fas fa-minus"></i>
                        </button>
                        <span class="mx-2 fw-bold">${item.quantity}</span>
                        <button class="cart-qty-btn" onclick="updateCartQuantity('${item.productId}', 1)">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button class="cart-item-remove" onclick="removeFromCart('${item.productId}')" title="Remove item">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            `;
        });
        
        cartItemsContainer.innerHTML = itemsHTML;
        
        if (cartSummary) {
            document.getElementById('cartSubtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('cartTotal').textContent = `$${subtotal.toFixed(2)}`;
            cartSummary.style.display = 'block';
        }
    }

    function updateCartQuantity(productId, change) {
        cartItems = JSON.parse(localStorage.getItem(CART_STORAGE_KEY) || '[]');
        
        const itemIndex = cartItems.findIndex(item => item.productId === productId);
        
        if (itemIndex >= 0) {
            const newQuantity = cartItems[itemIndex].quantity + change;
            
            if (newQuantity <= 0) {
                cartItems.splice(itemIndex, 1);
            } else {
                const product = PRODUCT_CATALOG[productId];
                if (product && product.pricing.retail !== null) {
                    const wasWholesale = cartItems[itemIndex].isWholesale;
                    const updatedPricing = getPricingTier(product, newQuantity);
                    
                    cartItems[itemIndex].quantity = newQuantity;
                    cartItems[itemIndex].price = updatedPricing.price;
                    cartItems[itemIndex].variantId = updatedPricing.variantId;
                    cartItems[itemIndex].pricingTier = updatedPricing.tier;
                    cartItems[itemIndex].isWholesale = updatedPricing.isWholesale;
                    
                    if (updatedPricing.isWholesale && !wasWholesale) {
                        showNotification(`üéâ Wholesale pricing activated! Saving $${updatedPricing.savingsPerUnit.toFixed(2)}/unit`, 'success');
                    } else if (!updatedPricing.isWholesale && wasWholesale) {
                        showNotification(`Quantity below wholesale threshold. Retail pricing applied.`, 'info');
                    }
                } else {
                    cartItems[itemIndex].quantity = newQuantity;
                }
            }
            
            localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cartItems));
            window.dispatchEvent(new Event('storage'));
            updateCartPreview();
            updateCartBadges();
        }
    }

    function removeFromCart(productId) {
        cartItems = JSON.parse(localStorage.getItem(CART_STORAGE_KEY) || '[]');
        cartItems = cartItems.filter(item => item.productId !== productId);
        localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cartItems));
        window.dispatchEvent(new Event('storage'));
        updateCartPreview();
        updateCartBadges();
        showNotification('Item removed from cart', 'info');
    }

    function clearCart() {
        if (confirm('Clear all items from cart?')) {
            cartItems = [];
            localStorage.setItem(CART_STORAGE_KEY, JSON.stringify([]));
            window.dispatchEvent(new Event('storage'));
            updateCartPreview();
            updateCartBadges();
            showNotification('Cart cleared', 'info');
        }
    }

    function updateCartBadges() {
        cartItems = JSON.parse(localStorage.getItem(CART_STORAGE_KEY) || '[]');
        
        const totalItems = Array.isArray(cartItems) 
            ? cartItems.reduce((sum, item) => sum + (item.quantity || 0), 0) 
            : 0;
        
        ['cartBadge', 'heroCartCount', 'floatingCartCount'].forEach(id => {
            const badge = document.getElementById(id);
            if (badge) {
                badge.textContent = totalItems;
                badge.style.display = totalItems > 0 ? 'inline-block' : 'none';
            }
        });
        
        const heroWrapper = document.getElementById('heroCartCountWrapper');
        if (heroWrapper) {
            heroWrapper.style.display = totalItems > 0 ? 'inline' : 'none';
        }
    }

    window.addEventListener('storage', function(e) {
        if (e.key === CART_STORAGE_KEY) {
            cartItems = JSON.parse(e.newValue || '[]');
            updateCartBadges();
            updateCartPreview();
            console.log('üîÑ Cart updated from another page');
        }
    });

    function toggleCart() {
        const cartPreview = document.getElementById('cartPreview');
        const cartOverlay = document.getElementById('cartOverlay');
        
        cartVisible = !cartVisible;
        
        if (cartVisible) {
            cartPreview.classList.add('show');
            cartOverlay.classList.add('show');
            updateCartPreview();
        } else {
            cartPreview.classList.remove('show');
            cartOverlay.classList.remove('show');
        }
    }

    function proceedToCart() {
        window.location.href = 'shop/cart.html';
    }

    function showNotification(message, type) {
        const notification = document.createElement('div');
        const alertClass = type === 'success' ? 'success' : type === 'error' ? 'danger' : type === 'warning' ? 'warning' : 'info';
        const icon = type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle';
        
        notification.className = `alert alert-${alertClass} position-fixed`;
        notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; max-width: 350px;';
        notification.innerHTML = `
            <i class="fas fa-${icon} me-2"></i>${message}
        `;
        document.body.appendChild(notification);
        setTimeout(() => notification.remove(), 3000);
    }

    function scrollToProducts() {
        document.getElementById('productSections').scrollIntoView({ behavior: 'smooth' });
    }

    function closeBanner() {
        const banner = document.getElementById('promoBanner');
        banner.style.display = 'none';
        localStorage.setItem('promoBannerClosed', 'true');
    }

    // ================================================================
    // INITIALIZE
    // ================================================================

    document.addEventListener('DOMContentLoaded', async function() {
        console.log('üéâ OHS Products Page Loading...');
        console.log('üì¶ Unified cart loaded with', cartItems.length, 'unique items');
        
        // Load Shopify configuration first
        const shopifyConfigured = await loadShopifyConfig();
        if (shopifyConfigured) {
            console.log('üîó Shopify Integration: Connected to', SHOPIFY_CONFIG.domain);
        } else {
            console.log('‚ö†Ô∏è Shopify Integration: Running without inventory tracking');
        }
        
        // Load products with inventory
        await loadProducts();
        
        updateCartBadges();
        updateCartPreview();
        
        if (localStorage.getItem('promoBannerClosed') === 'true') {
            const banner = document.getElementById('promoBanner');
            if (banner) banner.style.display = 'none';
        }
        
        const allProducts = Object.values(PRODUCT_CATALOG);
        const activeProducts = allProducts.filter(p => p.status === 'active');
        const comingSoonProducts = allProducts.filter(p => p.status === 'coming-soon' && !ENABLE_COMING_SOON_PRODUCTS[p.id]);
        
        const totalCountEl = document.getElementById('totalProductCount');
        const activeCountEl = document.getElementById('activeProductCount');
        const comingSoonCountEl = document.getElementById('comingSoonCount');
        
        if (totalCountEl) totalCountEl.textContent = allProducts.length;
        if (activeCountEl) activeCountEl.textContent = activeProducts.length;
        if (comingSoonCountEl) comingSoonCountEl.textContent = comingSoonProducts.length;
        
        console.log('‚úÖ Products page initialization complete');
        console.log('üí∞ Wholesale Pricing Thresholds:');
        allProducts.forEach(p => {
            if (p.wholesaleThreshold && p.pricing.retail !== null) {
                console.log(`   ${p.name}: ${p.wholesaleThreshold}+ units ‚Üí $${p.pricing.wholesale} (save $${(p.pricing.retail - p.pricing.wholesale).toFixed(2)}/unit)`);
            }
        });
        
        // Log inventory status
        console.log('üìä Inventory Status:');
        Object.keys(inventoryCache).forEach(productId => {
            const inv = inventoryCache[productId];
            const product = PRODUCT_CATALOG[productId];
            if (product) {
                console.log(`   ${product.name}: ${inv.totalInventory} in stock`);
            }
        });
        
        if (typeof gtag !== 'undefined') {
            gtag('event', 'page_view', {
                'page_title': 'Products',
                'page_location': window.location.href
            });
        }
    });
    
    // Export functions globally
    window.addToCart = addToCart;
    window.changeQuantity = changeQuantity;
    window.updateCartQuantity = updateCartQuantity;
    window.removeFromCart = removeFromCart;
    window.clearCart = clearCart;
    window.toggleCart = toggleCart;
    window.proceedToCart = proceedToCart;
    window.scrollToProducts = scrollToProducts;
    window.closeBanner = closeBanner;
    window.displayPricingInfo = displayPricingInfo;
    window.getPricingTier = getPricingTier;
    window.validateQuantity = validateQuantity;
    window.refreshInventoryDisplay = refreshInventoryDisplay;
    window.fetchShopifyInventory = fetchShopifyInventory;
    window.updateWholesaleIndicator = updateWholesaleIndicator;
    window.loadShopifyConfig = loadShopifyConfig;
    
    console.log('üöÄ Products Page JavaScript Loaded - Shopify Inventory Integration Active');
    console.log('üìß Contact: OHS@OrganicHypoSolutions.com');
</script>

</body>
</html>
